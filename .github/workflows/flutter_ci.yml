name: Flutter Continuous Intergration

on: 
  pull_request:
    branches: [ main ]
    paths:
      - lib/**
      - pubspec.yaml
  push:
    branches: [ main ]
    paths:
      - lib/**
      - pubspec.yaml
  workflow_dispatch:

jobs:
  build_apk:
      runs-on: windows-latest
      steps:
        - uses: actions/checkout@v2
          name: Set up the repo files
        - uses: subosito/flutter-action@v1
          name: Set up flutter
          with:
             flutter-version: '2.0.3'
        - run: flutter pub get
          name: Get flutter packages from pubspec.yaml
        - run: flutter build apk
          name: Build apk (android) version of the app
        - uses: EndBug/add-and-commit@v7.1.0
          name: Add & Commit
          with:
           author_name: Flutterfire CD
           author_email: halvorvivelstad@gmail.com
           message: 'Github action upload created apk'
           add: '/build/app/outputs/flutter-apk/app-release.apk'

            
