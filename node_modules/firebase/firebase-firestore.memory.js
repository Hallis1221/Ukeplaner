!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Xd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Xd);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},O=N||self;function D(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),P=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++P))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Y,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}t:{var K=O.navigator;if(K){K=K.userAgent;if(K){Y=K;break t}}Y=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=X(Y,"Opera"),it=X(Y,"Trident")||X(Y,"MSIE"),ot=X(Y,"Edge"),st=ot||it,ut=X(Y,"Gecko")&&!(X(Y.toLowerCase(),"webkit")&&!X(Y,"Edge"))&&!(X(Y,"Trident")||X(Y,"MSIE"))&&!X(Y,"Edge"),at=X(Y.toLowerCase(),"webkit")&&!X(Y,"Edge");function ct(){var t=O.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=Y,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=Q(String(nt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=O.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",D,e),O.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(It(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Dt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[_t]?e.wa(n,r,C(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[_t]?t.va(e,n,C(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=C(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=xt(t);if(c||(t[Ot]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):It(t)))}function Pt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return kt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new wt(e,this))}function xt(t){return(t=t[Ot])instanceof At?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function jt(){F.call(this),this.c=new At(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=qt(o,r,!0,e)&&s;if(s=qt(o=e.a=t,r,!0,e)&&s,s=qt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=qt(o=e.a=n[i],r,!1,e)&&s}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,F),jt.prototype[_t]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=C(i)?!!i.capture:!!i,r=Mt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(It(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=O.JSON.stringify;function Bt(){this.b=this.a=null}var zt,Ht=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Qt},function(t){t.reset()}));function Yt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Xt(t,e){var n;zt||(n=O.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Wt||(zt(),Wt=!0),Kt.add(t,e)}Bt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Wt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Wt=!1}function Zt(t,e){jt.call(this),this.b=t||1,this.a=e||O,this.f=x(this.Za,this),this.g=M()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j(Zt,jt),(A=Zt.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){Zt.X.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){F.call(this),this.b=t,this.a={}}j(ue,F);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();Ft(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();Ft(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ee={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ie(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ie.prototype.a=null;var Se,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Oe(){mt.call(this,"d")}function De(){mt.call(this,"c")}function Le(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Re,t=st?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Oe,mt),j(De,mt),j(Le,Ie),Se=new Le;var Re=45e3,Pe={},ke={};function Ve(t,e,n){t.H=1,t.i=nn(Ke(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=M(),Me(t),t.l=Ke(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(x(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?ke:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?ke:(u=u.substr(o,i),r.D=o+i,u)));if(u==ke){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),qe(t))}function Me(t){t.T=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(x(t.Va,t),e)}function Fe(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Yn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(x(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):$n(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Hn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Ce.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Be(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Ge(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,qe(this)):je(this,this.T-n)},(A=He.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Ye(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,Ze(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),Ze(this,n[3]||"",!0),$e(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ke(t){return new We(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?rn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function yn(t,e){return pn(t),e=gn(t,e),Qe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=B(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function On(){this.a=new Sn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Ln=O.JSON.parse;function Cn(t){jt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}j(Cn,jt);var Rn="",Pn=/^https?$/i,kn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),jn(t)}function Un(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))te(t.za,0,t);else if(Ft(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Bn("baseRetryDelayMs",5e3,t),this.Ra=Bn("retryDelaySeedMs",1e4,t),this.Ma=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,en(n=Ke(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=nn(Ke(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Yn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Qn(t){Yn(t),t.j&&(O.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Wn(t)}function Wn(t){_n(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Ve(n,r,e)}function Jn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function Zn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;C(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(x(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ke(e)),n.j=null,n.I=!0,xe(n,t)}function rr(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,Ft(i=ye(),new be(i)),Wn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(x(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Ya,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,O.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Qn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Ke(s):new We(s,void 0);return""!=a.c?(e&&Ze(a,e+"."+a.c),$e(a,a.h)):(u=O.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Je(u,r),i&&Ze(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Se),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Cn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),en(i=Ke(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Gn(i,this.i,r),In(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||_n(this.b)||Kn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(x(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Yn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Yn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Wn(t)},lr.prototype.close=function(){Hn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Gt(t),Xn(this.a,e)):Xn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Oe),j(dr,De),j(yr,hr),yr.prototype.ta=function(){Ft(this.a,"a")},yr.prototype.sa=function(t){Ft(this.a,new pr(t))},yr.prototype.ra=function(t){Ft(this.a,new dr)},yr.prototype.qa=function(){Ft(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.W,Cn.prototype.getResponseJson=Cn.prototype.Pa,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var vr=ye,gr=Ee,mr=Te,wr=pe,br=10,_r=11,Er=Ne,Tr=Cn,Ir=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ar=(Object.defineProperty(Sr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Sr.prototype.isEqual=function(t){return t instanceof Sr&&t.projectId===this.projectId&&t.database===this.database},Sr),Nr=new o("@firebase/firestore");function Sr(t,e){this.projectId=t,this.database=e||"(default)"}function Or(){return Nr.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.DEBUG&&(e=n.map(Rr),Nr.debug.apply(Nr,l(["Firestore (8.2.6): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.ERROR&&(e=n.map(Rr),Nr.error.apply(Nr,l(["Firestore (8.2.6): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.WARN&&(e=n.map(Rr),Nr.warn.apply(Nr,l(["Firestore (8.2.6): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.2.6) INTERNAL ASSERTION FAILED: "+t;throw Lr(t),new Error(t)}function kr(t){t||Pr()}var Vr=(xr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},xr);function xr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var jr=(Fr.fromBase64String=function(t){return new Fr(atob(t))},Fr.fromUint8Array=function(t){return new Fr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Fr.prototype.toBase64=function(){return t=this.h,btoa(t);var t},Fr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},Fr.prototype.l=function(){return 2*this.h.length},Fr.prototype._=function(t){return Ur(this.h,t.h)},Fr.prototype.isEqual=function(t){return this.h===t.h},Fr);function Fr(t){this.h=t}jr.T=new jr("");var qr,Gr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=(f(Xr,qr=Error),Xr),zr=(Qr.fromBase64String=function(t){try{return new Qr(jr.fromBase64String(t))}catch(t){throw new Br(Gr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Qr.fromUint8Array=function(t){return new Qr(jr.fromUint8Array(t))},Qr.prototype.toBase64=function(){return this.I.toBase64()},Qr.prototype.toUint8Array=function(){return this.I.toUint8Array()},Qr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Qr.prototype.isEqual=function(t){return this.I.isEqual(t.I)},Qr),Hr=(Yr.prototype.m=function(){return null!=this.uid},Yr.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},Yr.prototype.isEqual=function(t){return t.uid===this.uid},Yr);function Yr(t){this.uid=t}function Qr(t){this.I=t}function Xr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Hr.UNAUTHENTICATED=new Hr(null),Hr.R=new Hr("google-credentials-uid"),Hr.P=new Hr("first-party-uid");function Wr(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}var Kr=(oi.prototype.getToken=function(){return Promise.resolve(null)},oi.prototype.p=function(){},oi.prototype.v=function(t){(this.V=t)(Hr.UNAUTHENTICATED)},oi.prototype.S=function(){this.V=null},oi),Jr=(ii.prototype.getToken=function(){var e=this,n=this.N,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.N!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Wr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},ii.prototype.p=function(){this.forceRefresh=!0},ii.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},ii.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},ii.prototype.F=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new Hr(t)},ii),Zr=(Object.defineProperty(ri.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.k},e=this.O.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ri),$r=(ni.prototype.getToken=function(){return Promise.resolve(new Zr(this.O,this.k))},ni.prototype.v=function(t){t(Hr.P)},ni.prototype.S=function(){},ni.prototype.p=function(){},ni),ti=(ei.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ei.prototype.next=function(){var t=++this.previousValue;return this.$&&this.$(t),t},ei);function ei(t,e){var n=this;this.previousValue=t,e&&(e.M=function(t){return n.L(t)},this.$=function(t){return e.B(t)})}function ni(t,e){this.O=t,this.k=e}function ri(t,e){this.O=t,this.k=e,this.type="FirstParty",this.user=Hr.P}function ii(t){var e=this;this.D=null,this.currentUser=Hr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.F(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}function oi(){this.V=null}ti.q=-1;var si,ui,ai=(wi.now=function(){return wi.fromMillis(Date.now())},wi.fromDate=function(t){return wi.fromMillis(t.getTime())},wi.fromMillis=function(t){var e=Math.floor(t/1e3);return new wi(e,1e6*(t-1e3*e))},wi.prototype.toDate=function(){return new Date(this.toMillis())},wi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},wi.prototype.U=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},wi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},wi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},wi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},wi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},wi),ci=(mi.K=function(t){return new mi(t)},mi.min=function(){return new mi(new ai(0,0))},mi.prototype._=function(t){return this.timestamp.U(t.timestamp)},mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},mi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},mi.prototype.j=function(){return this.timestamp},mi),Te=(Object.defineProperty(gi.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),gi.prototype.isEqual=function(t){return 0===gi.H(this,t)},gi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof gi?t.forEach(function(t){e.push(t)}):e.push(t),this.J(e)},gi.prototype.limit=function(){return this.offset+this.length},gi.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},gi.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},gi.prototype.Z=function(){return this.segments[this.offset]},gi.prototype.tt=function(){return this.get(this.length-1)},gi.prototype.get=function(t){return this.segments[this.offset+t]},gi.prototype.et=function(){return 0===this.length},gi.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},gi.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},gi.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},gi),hi=(f(vi,ui=Te),vi.prototype.J=function(t,e,n){return new vi(t,e,n)},vi.prototype.rt=function(){return this.it().join("/")},vi.prototype.toString=function(){return this.rt()},vi.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new vi(n)},vi.ct=function(){return new vi([])},vi),fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,li=(f(yi,si=Te),yi.prototype.J=function(t,e,n){return new yi(t,e,n)},yi.at=function(t){return fi.test(t)},yi.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yi.at(t)||(t="`"+t+"`"),t}).join(".")},yi.prototype.toString=function(){return this.rt()},yi.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},yi.ht=function(){return new yi(["__name__"])},yi.lt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Br(Gr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Br(Gr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Br(Gr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new yi(e)},yi.ct=function(){return new yi([])},yi),pi=(di._t=function(t){return new di(hi.ot(t))},di.ft=function(t){return new di(hi.ot(t).Y(5))},di.prototype.dt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},di.prototype.isEqual=function(t){return null!==t&&0===hi.H(this.path,t.path)},di.prototype.toString=function(){return this.path.toString()},di.H=function(t,e){return hi.H(t.path,e.path)},di.wt=function(t){return t.length%2==0},di.Et=function(t){return new di(new hi(t.slice()))},di);function di(t){this.path=t}function yi(){return null!==si&&si.apply(this,arguments)||this}function vi(){return null!==ui&&ui.apply(this,arguments)||this}function gi(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.G=n}function mi(t){this.timestamp=t}function wi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function bi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ei(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ti=(Ai.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},Ai.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ai),Ii=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(t){(this.fields=t).sort(li.H)}function Ni(t){if(kr(!!t),"string"!=typeof t)return{seconds:Si(t.seconds),nanos:Si(t.nanos)};var e=0,n=Ii.exec(t);kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Si(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Oi(t){return"string"==typeof t?jr.fromBase64String(t):jr.fromUint8Array(t)}function Di(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Li(t){t=Ni(t.mapValue.fields.__local_write_time__.timestampValue);return new ai(t.seconds,t.nanos)}function Ci(t){return null==t}function Ri(t){return 0===t&&1/t==-1/0}function Pi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Di(t)?4:10:Pr()}function ki(r,i){var t,e=Pi(r);if(e!==Pi(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Li(r).isEqual(Li(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ni(r.timestampValue),t=Ni(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Oi(r.bytesValue).isEqual(Oi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Si((t=r).geoPointValue.latitude)===Si(e.geoPointValue.latitude)&&Si(t.geoPointValue.longitude)===Si(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Si(t.integerValue)===Si(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Si(t.doubleValue),e=Si(e.doubleValue);return t===e?Ri(t)===Ri(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],ki);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(bi(e)!==bi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!ki(e[t],n[t])))return!1;return!0}();default:return Pr()}}function Vi(t,e){return void 0!==(t.values||[]).find(function(t){return ki(t,e)})}function xi(t,e){var n,r,i=Pi(t),o=Pi(e);if(i!==o)return Ur(i,o);switch(i){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return n=e,r=Si(t.integerValue||t.doubleValue),n=Si(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ui(t.timestampValue,e.timestampValue);case 4:return Ui(Li(t),Li(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return function(t,e){t=Oi(t),e=Oi(e);return t._(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Ur(Si(i.latitude),Si(r.latitude)))?n:Ur(Si(i.longitude),Si(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=xi(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;u=xi(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function Ui(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Ni(t),t=Ni(e),e=Ur(n.seconds,t.seconds);return 0!==e?e:Ur(n.nanos,t.nanos)}function Mi(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ni(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Oi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,pi.ft(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function ji(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function Fi(t){return t&&"integerValue"in t}function qi(t){return!!t&&"arrayValue"in t}function Gi(t){return t&&"nullValue"in t}function Bi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zi(t){return t&&"mapValue"in t}var Hi=(Xi.empty=function(){return new Xi({mapValue:{}})},Xi.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},Xi.prototype.isEqual=function(t){return ki(this.proto,t.proto)},Xi),Yi=(Qi.prototype.set=function(t,e){return this.Rt(t,e),this},Qi.prototype.delete=function(t){return this.Rt(t,null),this},Qi.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Pi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.tt(),e)},Qi.prototype.Pt=function(){var t=this.yt(li.ct(),this.At);return null!=t?new Hi(t):this.It},Qi.prototype.yt=function(r,t){var i=this,o=!1,e=this.It.field(r),s=zi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.yt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qi);function Qi(t){void 0===t&&(t=Hi.empty()),this.It=t,this.At=new Map}function Xi(t){this.proto=t}var Wi,Ki,Ji,o=function(t,e){this.key=t,this.version=e},Zi=(f(io,Ji=o),io.prototype.field=function(t){return this.gt.field(t)},io.prototype.data=function(){return this.gt},io.prototype.bt=function(){return this.gt.proto},io.prototype.isEqual=function(t){return t instanceof io&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},io.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),io),$i=(f(ro,Ki=o),ro.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){return t instanceof ro&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ro),to=(f(no,Wi=o),no.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(no.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),no.prototype.isEqual=function(t){return t instanceof no&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},no),eo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function no(){return null!==Wi&&Wi.apply(this,arguments)||this}function ro(t,e,n){var r=this;return(r=Ki.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function io(t,e,n,r){var i=this;return(i=Ji.call(this,t,e)||this).gt=n,i.Vt=!!r.Vt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function oo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new eo(t,e,n,r,i,o,s)}function so(t){var e=t;return null===e.vt&&(t=e.path.rt(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.rt()+t.op.toString()+Mi(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.rt()+t.dir}).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=xo(e.startAt)),e.endAt&&(t+="|ub:",t+=xo(e.endAt)),e.vt=t),e.vt}function uo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!ki(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!jo(t.startAt,e.startAt)&&jo(t.endAt,e.endAt)}function ao(t){return pi.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var co,ho=(f(fo,co=function(){}),fo.create=function(t,e,n){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,n):new vo(t,e,n):"array-contains"===e?new So(t,n):"in"===e?new Oo(t,n):"not-in"===e?new Do(t,n):"array-contains-any"===e?new Lo(t,n):new fo(t,e,n)},fo.St=function(t,e,n){return new("in"===e?go:mo)(t,n)},fo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Dt(xi(t,this.value)):null!==t&&Pi(this.value)===Pi(t)&&this.Dt(xi(t,this.value))},fo.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},fo.prototype.Ct=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},fo);function fo(t,e,n){var r=this;return(r=co.call(this)||this).field=t,r.op=e,r.value=n,r}var lo,po,yo,vo=(f(_o,yo=ho),_o.prototype.matches=function(t){t=pi.H(t.key,this.key);return this.Dt(t)},_o),go=(f(bo,po=ho),bo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},bo),mo=(f(wo,lo=ho),wo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},wo);function wo(t,e){var n=this;return(n=lo.call(this,t,"not-in",e)||this).keys=Eo(0,e),n}function bo(t,e){var n=this;return(n=po.call(this,t,"in",e)||this).keys=Eo(0,e),n}function _o(t,e,n){var r=this;return(r=yo.call(this,t,e,n)||this).key=pi.ft(n.referenceValue),r}function Eo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return pi.ft(t.referenceValue)})}var To,Io,Ao,No,So=(f(Vo,No=ho),Vo.prototype.matches=function(t){t=t.field(this.field);return qi(t)&&Vi(t.arrayValue,this.value)},Vo),Oo=(f(ko,Ao=ho),ko.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Vi(this.value.arrayValue,t)},ko),Do=(f(Po,Io=ho),Po.prototype.matches=function(t){if(Vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Vi(this.value.arrayValue,t)},Po),Lo=(f(Ro,To=ho),Ro.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!qi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vi(e.value.arrayValue,t)})},Ro),Co=function(t,e){this.position=t,this.before=e};function Ro(t,e){return To.call(this,t,"array-contains-any",e)||this}function Po(t,e){return Io.call(this,t,"not-in",e)||this}function ko(t,e){return Ao.call(this,t,"in",e)||this}function Vo(t,e){return No.call(this,t,"array-contains",e)||this}function xo(t){return(t.before?"b":"a")+":"+t.position.map(Mi).join(",")}var Uo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Mo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ut()?pi.H(pi.ft(s.referenceValue),n.key):xi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function jo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ki(t.position[n],e.position[n]))return!1;return!0}var Fo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.Ft=null,this.startAt,this.endAt};function qo(t){return new Fo(t)}function Go(t){return!Ci(t.limit)&&"F"===t.limitType}function Bo(t){return!Ci(t.limit)&&"L"===t.limitType}function zo(t){return 0<t.xt.length?t.xt[0].field:null}function Ho(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Yo(t){return null!==t.collectionGroup}function Qo(t){var e=t;if(null===e.Nt){e.Nt=[];var n=Ho(e),t=zo(e);if(null!==n&&null===t)n.ut()||e.Nt.push(new Uo(n)),e.Nt.push(new Uo(li.ht(),"asc"));else{for(var r=!1,i=0,o=e.xt;i<o.length;i++){var s=o[i];e.Nt.push(s),s.field.ut()&&(r=!0)}r||(n=0<e.xt.length?e.xt[e.xt.length-1].dir:"asc",e.Nt.push(new Uo(li.ht(),n)))}}return e.Nt}function Xo(t){var e=t;if(!e.Ft)if("F"===e.limitType)e.Ft=oo(e.path,e.collectionGroup,Qo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Qo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Uo(o.field,s))}var u=e.endAt?new Co(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Co(e.startAt.position,!e.startAt.before):null;e.Ft=oo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ft}function Wo(t,e,n){return new Fo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ko(t,e){return uo(Xo(t),Xo(e))&&t.limitType===e.limitType}function Jo(t){return so(Xo(t))+"|lt:"+t.limitType}function Zo(t){return"Query(target="+(e=Xo(t),n=e.path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.rt()+" "+t.op+" "+Mi(t.value)}).join(", ")+"]"),Ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.rt()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+xo(e.startAt)),e.endAt&&(n+=", endAt: "+xo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function $o(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.dt(e.collectionGroup)&&e.path.nt(n):pi.wt(e.path)?e.path.isEqual(n):e.path.st(n))&&function(t){for(var e=0,n=i.xt;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Mo(t.startAt,Qo(t),n))&&(!t.endAt||!Mo(t.endAt,Qo(t),n)));var e,n}function ts(u){return function(t,e){for(var n=!1,r=0,i=Qo(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.ut()?pi.H(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?xi(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ut()}return 0}}var es=(ns.prototype.Mt=function(t){return new ns(this.target,this.targetId,this.Ot,t,this.kt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ns.prototype.Lt=function(t,e){return new ns(this.target,this.targetId,this.Ot,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ns.prototype.$t=function(t){return new ns(this.target,this.targetId,this.Ot,this.sequenceNumber,this.kt,t,this.resumeToken)},ns);function ns(t,e,n,r,i,o,s){void 0===i&&(i=ci.min()),void 0===o&&(o=ci.min()),void 0===s&&(s=jr.T),this.target=t,this.targetId=e,this.Ot=n,this.sequenceNumber=r,this.kt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function rs(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ri(e)?"-0":e}}function is(t){return{integerValue:""+t}}function os(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ri(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?is(e):rs(t,e);var n}Te=function(){this.qt=void 0};function ss(t,e){return t instanceof ws?Fi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var us,as,cs=(f(ls,as=Te),ls),hs=(f(fs,us=Te),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return ki(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(f(vs,ds=Te),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!ki(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(f(bs,ms=Te),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).Qt=t,n.Ut=e,n}function _s(t){return Si(t.integerValue||t.doubleValue)}function Es(t){return qi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ts(t,e){this.field=t,this.transform=e}function Is(t,e){this.version=t,this.transformResults=e}var As=(Ns.Kt=function(){return new Ns},Ns.exists=function(t){return new Ns(void 0,t)},Ns.updateTime=function(t){return new Ns(t)},Object.defineProperty(Ns.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ns.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ns);function Ns(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof Zi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Zi}o=function(){};function Os(t,e,n){return t instanceof Ps?function(t,e,n){if(!Ss(t.jt,e))return e;var r=t.value,n=js(t.fieldTransforms,n,e),r=Fs(t.fieldTransforms,r,n),e=Ls(e);return new Zi(t.key,e,r,{Vt:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(!Ss(t.jt,e))return e;var r=Ls(e),e=Us(t,e,js(t.fieldTransforms,n,e));return new Zi(t.key,r,e,{Vt:!0})}(t,e,n):(e=e,Ss((t=t).jt,e)?new $i(t.key,ci.min()):e)}function Ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Mr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof hs&&e instanceof hs||t instanceof ys&&e instanceof ys?Mr(t.elements,e.elements,ki):t instanceof ws&&e instanceof ws?ki(t.Ut,e.Ut):t instanceof cs&&e instanceof cs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function Ls(t){return t instanceof Zi?t.version:ci.min()}var Cs,Rs,Ps=(f(xs,Rs=o),xs),ks=(f(Vs,Cs=o),Vs);function Vs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Cs.call(this)||this).key=t,o.data=e,o.Gt=n,o.jt=r,o.fieldTransforms=i,o.type=1,o}function xs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Rs.call(this)||this).key=t,i.value=e,i.jt=n,i.fieldTransforms=r,i.type=0,i}function Us(t,e,n){var r,i,o;return i=t,e=r=e instanceof Zi?e.data():Hi.empty(),o=new Yi(e),i.Gt.fields.forEach(function(t){var e;t.et()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Pt(),Fs(t.fieldTransforms,r,n)}function Ms(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Zi&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof hs?ps(o,s):o instanceof ys?gs(o,s):u))}return r}function js(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Zi&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof cs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof hs?ps(a,r):a instanceof ys?gs(a,r):(a=ss(c=a,r),r=_s(a)+_s(c.Ut),Fi(a)&&Fi(c.Ut)?is(r):rs(c.Qt,r))))}return i}function Fs(t,e,n){for(var r=new Yi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}function qs(t){this.count=t}var Gs,Bs,zs,Hs=(f(Xs,zs=o),Xs),Ys=(f(Qs,Bs=o),Qs);function Qs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.jt=e,n.type=3,n.fieldTransforms=[],n}function Xs(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.jt=e,n.type=2,n.fieldTransforms=[],n}function Ws(t){switch(t){case Gr.OK:return Pr(),0;case Gr.CANCELLED:case Gr.UNKNOWN:case Gr.DEADLINE_EXCEEDED:case Gr.RESOURCE_EXHAUSTED:case Gr.INTERNAL:case Gr.UNAVAILABLE:case Gr.UNAUTHENTICATED:return;case Gr.INVALID_ARGUMENT:case Gr.NOT_FOUND:case Gr.ALREADY_EXISTS:case Gr.PERMISSION_DENIED:case Gr.FAILED_PRECONDITION:case Gr.ABORTED:case Gr.OUT_OF_RANGE:case Gr.UNIMPLEMENTED:case Gr.DATA_LOSS:return 1;default:return Pr(),0}}function Ks(t){if(void 0===t)return Lr("GRPC error has no .code"),Gr.UNKNOWN;switch(t){case Gs.OK:return Gr.OK;case Gs.CANCELLED:return Gr.CANCELLED;case Gs.UNKNOWN:return Gr.UNKNOWN;case Gs.DEADLINE_EXCEEDED:return Gr.DEADLINE_EXCEEDED;case Gs.RESOURCE_EXHAUSTED:return Gr.RESOURCE_EXHAUSTED;case Gs.INTERNAL:return Gr.INTERNAL;case Gs.UNAVAILABLE:return Gr.UNAVAILABLE;case Gs.UNAUTHENTICATED:return Gr.UNAUTHENTICATED;case Gs.INVALID_ARGUMENT:return Gr.INVALID_ARGUMENT;case Gs.NOT_FOUND:return Gr.NOT_FOUND;case Gs.ALREADY_EXISTS:return Gr.ALREADY_EXISTS;case Gs.PERMISSION_DENIED:return Gr.PERMISSION_DENIED;case Gs.FAILED_PRECONDITION:return Gr.FAILED_PRECONDITION;case Gs.ABORTED:return Gr.ABORTED;case Gs.OUT_OF_RANGE:return Gr.OUT_OF_RANGE;case Gs.UNIMPLEMENTED:return Gr.UNIMPLEMENTED;case Gs.DATA_LOSS:return Gr.DATA_LOSS;default:return Pr()}}(Te=Gs=Gs||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var Js=(nu.prototype.zt=function(t,e){return new nu(this.H,this.root.zt(t,e,this.H).copy(null,null,$s.Ht,null,null))},nu.prototype.remove=function(t){return new nu(this.H,this.root.remove(t,this.H).copy(null,null,$s.Ht,null,null))},nu.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},nu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},nu.prototype.et=function(){return this.root.et()},Object.defineProperty(nu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),nu.prototype.Jt=function(){return this.root.Jt()},nu.prototype.Yt=function(){return this.root.Yt()},nu.prototype.Xt=function(t){return this.root.Xt(t)},nu.prototype.forEach=function(n){this.Xt(function(t,e){return n(t,e),!1})},nu.prototype.toString=function(){var n=[];return this.Xt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},nu.prototype.Zt=function(t){return this.root.Zt(t)},nu.prototype.te=function(){return new Zs(this.root,null,this.H,!1)},nu.prototype.ee=function(t){return new Zs(this.root,t,this.H,!1)},nu.prototype.ne=function(){return new Zs(this.root,null,this.H,!0)},nu.prototype.se=function(t){return new Zs(this.root,t,this.H,!0)},nu),Zs=(eu.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},eu.prototype.ce=function(){return 0<this.re.length},eu.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},eu),$s=(tu.prototype.copy=function(t,e,n,r,i){return new tu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},tu.prototype.et=function(){return!1},tu.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},tu.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},tu.prototype.min=function(){return this.left.et()?this:this.left.min()},tu.prototype.Jt=function(){return this.min().key},tu.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},tu.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},tu.prototype.he=function(){if(this.left.et())return tu.EMPTY;var t=this;return t.left.le()||t.left.left.le()||(t=t._e()),(t=t.copy(null,null,null,t.left.he(),null)).ue()},tu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.et()||r.left.le()||r.left.left.le()||(r=r._e()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.le()&&(r=r.fe()),r.right.et()||r.right.le()||r.right.left.le()||(r=r.de()),0===e(t,r.key)){if(r.right.et())return tu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.he())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.ue()},tu.prototype.le=function(){return this.color},tu.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},tu.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},tu.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},tu.prototype.we=function(){var t=this.copy(null,null,tu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},tu.prototype.fe=function(){var t=this.copy(null,null,tu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},tu.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},tu.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},tu.prototype.Ie=function(){if(this.le()&&this.left.le())throw Pr();if(this.right.le())throw Pr();var t=this.left.Ie();if(t!==this.right.Ie())throw Pr();return t+(this.le()?0:1)},tu);function tu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:tu.RED,this.left=null!=r?r:tu.EMPTY,this.right=null!=i?i:tu.EMPTY,this.size=this.left.size+1+this.right.size}function eu(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}function nu(t,e){this.H=t,this.root=e||$s.EMPTY}function ru(){this.size=0}$s.EMPTY=null,$s.RED=!0,$s.Ht=!1,$s.EMPTY=(Object.defineProperty(ru.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ru.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ru.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ru.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ru.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),ru.prototype.copy=function(t,e,n,r,i){return this},ru.prototype.zt=function(t,e,n){return new $s(t,e)},ru.prototype.remove=function(t,e){return this},ru.prototype.et=function(){return!0},ru.prototype.Xt=function(t){return!1},ru.prototype.Zt=function(t){return!1},ru.prototype.Jt=function(){return null},ru.prototype.Yt=function(){return null},ru.prototype.le=function(){return!1},ru.prototype.Te=function(){return!0},ru.prototype.Ie=function(){return 0},new ru);var iu=(au.prototype.has=function(t){return null!==this.data.get(t)},au.prototype.first=function(){return this.data.Jt()},au.prototype.last=function(){return this.data.Yt()},Object.defineProperty(au.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),au.prototype.indexOf=function(t){return this.data.indexOf(t)},au.prototype.forEach=function(n){this.data.Xt(function(t,e){return n(t),!1})},au.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(0<=this.H(r.key,t[1]))return;e(r.key)}},au.prototype.Ae=function(t,e){for(var n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},au.prototype.Re=function(t){t=this.data.ee(t);return t.ce()?t.oe().key:null},au.prototype.te=function(){return new ou(this.data.te())},au.prototype.ee=function(t){return new ou(this.data.ee(t))},au.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},au.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},au.prototype.et=function(){return this.data.et()},au.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},au.prototype.isEqual=function(t){if(!(t instanceof au))return!1;if(this.size!==t.size)return!1;for(var e=this.data.te(),n=t.data.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(0!==this.H(r,i))return!1}return!0},au.prototype.it=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},au.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},au.prototype.copy=function(t){var e=new au(this.H);return e.data=t,e},au),ou=(uu.prototype.oe=function(){return this.ye.oe().key},uu.prototype.ce=function(){return this.ye.ce()},uu),su=new Js(pi.H);function uu(t){this.ye=t}function au(t){this.H=t,this.data=new Js(this.H)}var cu=new Js(pi.H);var hu=new Js(pi.H);var fu=new iu(pi.H);function lu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=fu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var pu=new iu(Ur);var du=(Lu.pe=function(t){return new Lu(t.H)},Lu.prototype.has=function(t){return null!=this.ge.get(t)},Lu.prototype.get=function(t){return this.ge.get(t)},Lu.prototype.first=function(){return this.Ve.Jt()},Lu.prototype.last=function(){return this.Ve.Yt()},Lu.prototype.et=function(){return this.Ve.et()},Lu.prototype.indexOf=function(t){t=this.ge.get(t);return t?this.Ve.indexOf(t):-1},Object.defineProperty(Lu.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),Lu.prototype.forEach=function(n){this.Ve.Xt(function(t,e){return n(t),!1})},Lu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},Lu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},Lu.prototype.isEqual=function(t){if(!(t instanceof Lu))return!1;if(this.size!==t.size)return!1;for(var e=this.Ve.te(),n=t.Ve.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(!r.isEqual(i))return!1}return!0},Lu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Lu.prototype.copy=function(t,e){var n=new Lu;return n.H=this.H,n.ge=t,n.Ve=e,n},Lu),yu=(Du.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);!n||0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Pr()},Du.prototype.ve=function(){var n=[];return this.be.Xt(function(t,e){n.push(e)}),n},Du),vu=(Ou.Ne=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ou(t,e,du.pe(e),i,n,r,!0,!1)},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ou),gu=(Su.Le=function(t,e){var n=new Map;return n.set(t,mu.$e(t,e)),new Su(ci.min(),n,pu,su,lu())},Su),mu=(Nu.$e=function(t,e){return new Nu(jr.T,e,lu(),lu(),lu())},Nu),wu=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},bu=function(t,e){this.targetId=t,this.je=e},_u=function(t,e,n,r){void 0===n&&(n=jr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Eu=(Object.defineProperty(Au.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Au.prototype.tn=function(t){0<t.l()&&(this.Ye=!0,this.He=t)},Au.prototype.en=function(){var n=lu(),r=lu(),i=lu();return this.ze.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new mu(this.He,this.Je,n,r,i)},Au.prototype.nn=function(){this.Ye=!1,this.ze=Ru()},Au.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},Au.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},Au.prototype.on=function(){this.Ge+=1},Au.prototype.cn=function(){--this.Ge},Au.prototype.an=function(){this.Ye=!0,this.Je=!0},Au),Tu=(Iu.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Zi?this.wn(r,t.We):t.We instanceof $i&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},Iu.prototype.Tn=function(n){var r=this;this.In(n,function(t){var e=r.mn(t);switch(n.state){case 0:r.An(t)&&e.tn(n.resumeToken);break;case 1:e.cn(),e.Xe||e.nn(),e.tn(n.resumeToken);break;case 2:e.cn(),e.Xe||r.removeTarget(t);break;case 3:r.An(t)&&(e.an(),e.tn(n.resumeToken));break;case 4:r.An(t)&&(r.Rn(t),e.tn(n.resumeToken));break;default:Pr()}})},Iu.prototype.In=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.hn.forEach(function(t,e){r.An(e)&&n(e)})},Iu.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,t=this.yn(e);t&&(ao(t=t.target)?0===n?(t=new pi(t.path),this.En(e,t,new $i(t,ci.min()))):kr(1===n):this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e)))},Iu.prototype.Vn=function(r){var i=this,o=new Map;this.hn.forEach(function(t,e){var n=i.yn(e);n&&(t.Be&&ao(n.target)&&(n=new pi(n.target.path),null!==i.ln.get(n)||i.pn(e,n)||i.En(e,n,new $i(n,r))),t.Ze&&(o.set(e,t.en()),t.nn()))});var s=lu();this._n.forEach(function(t,e){var n=!0;e.Ae(function(t){t=i.yn(t);return!t||2===t.Ot||(n=!1)}),n&&(s=s.add(t))});var t=new gu(r,o,this.fn,this.ln,s);return this.ln=su,this._n=Cu(),this.fn=new iu(Ur),t},Iu.prototype.wn=function(t,e){var n;this.An(t)&&(n=this.pn(t,e.key)?2:0,this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t)))},Iu.prototype.En=function(t,e,n){var r;this.An(t)&&(r=this.mn(t),this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n)))},Iu.prototype.removeTarget=function(t){this.hn.delete(t)},Iu.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},Iu.prototype.on=function(t){this.mn(t).on()},Iu.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new Eu,this.hn.set(t,e)),e},Iu.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new iu(Ur),this._n=this._n.zt(t,e)),e},Iu.prototype.An=function(t){var e=null!==this.yn(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},Iu.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},Iu.prototype.Rn=function(e){var n=this;this.hn.set(e,new Eu),this.un.vn(e).forEach(function(t){n.En(e,t,null)})},Iu.prototype.pn=function(t,e){return this.un.vn(t).has(e)},Iu);function Iu(t){this.un=t,this.hn=new Map,this.ln=su,this._n=Cu(),this.fn=new iu(Ur)}function Au(){this.Ge=0,this.ze=Ru(),this.He=jr.T,this.Je=!1,this.Ye=!0}function Nu(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}function Su(t,e,n,r,i){this.kt=t,this.Fe=e,this.Oe=n,this.ke=r,this.Me=i}function Ou(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}function Du(){this.be=new Js(pi.H)}function Lu(n){this.H=n?function(t,e){return n(t,e)||pi.H(t.key,e.key)}:function(t,e){return pi.H(t.key,e.key)},this.ge=cu,this.Ve=new Js(this.H)}function Cu(){return new Js(pi.H)}function Ru(){return new Js(pi.H)}var Pu={asc:"ASCENDING",desc:"DESCENDING"},ku={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vu=function(t,e){this.t=t,this.Bt=e};function xu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Mu(t){return kr(!!t),ci.K((t=Ni(t),new ai(t.seconds,t.nanos)))}function ju(t,e){return new hi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).rt()}function Fu(t){t=hi.ot(t);return kr(ea(t)),t}function qu(t,e){return ju(t.t,e.path)}function Gu(t,e){e=Fu(e);if(e.get(1)!==t.t.projectId)throw new Br(Gr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Br(Gr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new pi(Hu(e))}function Bu(t,e){return ju(t.t,e)}function zu(t){return new hi(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Hu(t){return kr(4<t.length&&"documents"===t.get(4)),t.Y(5)}function Yu(t,e,n){return{name:qu(t,e),fields:n.proto.mapValue.fields}}function Qu(t,e){var n,r,i;if(e instanceof Ps)n={update:Yu(t,e.key,e.value)};else if(e instanceof Hs)n={delete:qu(t,e.key)};else if(e instanceof ks)n={update:Yu(t,e.key,e.data),updateMask:(i=e.Gt,r=[],i.fields.forEach(function(t){return r.push(t.rt())}),{fieldPaths:r})};else{if(!(e instanceof Ys))return Pr();n={verify:qu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof cs)return{fieldPath:t.field.rt(),setToServerValue:"REQUEST_TIME"};if(e instanceof hs)return{fieldPath:t.field.rt(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.rt(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.rt(),increment:e.Ut};throw Pr()})),e.jt.Wt||(n.currentDocument=void 0!==(i=e.jt).updateTime?{updateTime:(e=t,t=i.updateTime,xu(e,t.j()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function Xu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bu(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Bi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NAN"}};if(Gi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Bi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NAN"}};if(Gi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zu(t.field),op:(e=t.op,ku[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Zu((t=t).field),direction:(t=t.dir,Pu[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Bt||Ci(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Ku(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ku(e.endAt)),n}function Wu(t){var e=4===(o=Fu(t.parent)).length?hi.ct():Hu(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ta(t)]:void 0!==t.fieldFilter?[(n=t,ho.create($u(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Uo($u((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ci(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Ju(n.startAt));var u=null;return n.endAt&&(u=Ju(n.endAt)),new Fo(e,i,t,o,r,"F",s,u)}function Ku(t){return{before:t.before,values:t.position}}function Ju(t){var e=!!t.before,t=t.values||[];return new Co(t,e)}function Zu(t){return{fieldPath:t.rt()}}function $u(t){return li.lt(t.fieldPath)}function ta(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$u(t.unaryFilter.field);return ho.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=$u(t.unaryFilter.field);return ho.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=$u(t.unaryFilter.field);return ho.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=$u(t.unaryFilter.field);return ho.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function ea(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var na=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ra=(ia.prototype.catch=function(t){return this.next(void 0,t)},ia.prototype.next=function(r,i){var o=this;return this.Nn&&Pr(),this.Nn=!0,this.xn?this.error?this.Fn(i,this.error):this.On(r,this.result):new ia(function(e,n){o.Dn=function(t){o.On(r,t).next(e,n)},o.Cn=function(t){o.Fn(i,t).next(e,n)}})},ia.prototype.kn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ia.prototype.Mn=function(t){try{var e=t();return e instanceof ia?e:ia.resolve(e)}catch(t){return ia.reject(t)}},ia.prototype.On=function(t,e){return t?this.Mn(function(){return t(e)}):ia.resolve(e)},ia.prototype.Fn=function(t,e){return t?this.Mn(function(){return t(e)}):ia.reject(e)},ia.resolve=function(n){return new ia(function(t,e){t(n)})},ia.reject=function(n){return new ia(function(t,e){e(n)})},ia.Ln=function(t){return new ia(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ia.$n=function(t){for(var n=ia.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ia.resolve(t):e()})}(r[e]);return n},ia.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},ia);function ia(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}function oa(t){return"IndexedDbTransactionError"===t.name}var sa=(ua.Ts=function(t,e,n,r,i){i=new ua(t,e,Date.now()+n,r,i);return i.start(n),i},ua.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},ua.prototype.Rs=function(){return this.As()},ua.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Br(Gr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ua.prototype.As=function(){var e=this;this._s.Ps(function(){return null!==e.Is?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},ua.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},ua);function ua(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new na,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function aa(t,e){if(Lr("AsyncQueue",e+": "+t),oa(t))return new Br(Gr.UNAVAILABLE,e+": "+t);throw t}function ca(t){this.Os=t}var o=(da.prototype.gs=function(t){this.ys.push(t)},da.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},da),ha=(pa.prototype.Ss=function(t,e,n){for(var r,i,o,s,u,a,c=n.Ds,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Ps?(u=o,f=(s=r).value,u.transformResults&&(a=Ms(s.fieldTransforms,i,u.transformResults),f=Fs(s.fieldTransforms,f,a)),new Zi(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof ks?function(t,e,n){if(!Ss(t.jt,e))return new to(t.key,n.version);e=Us(t,e,n.transformResults?Ms(t.fieldTransforms,e,n.transformResults):[]);return new Zi(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new $i(r.key,o.version,{hasCommittedMutations:!0}))}return e},pa.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Os(i,e,this.vs));for(var i,o=0,s=this.mutations;o<s.length;o++){(i=s[o]).key.isEqual(t)&&(e=Os(i,e,this.vs))}return e},pa.prototype.xs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Cs(t.key,n.get(t.key));e&&(i=i.zt(t.key,e))}),i},pa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},lu())},pa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Ds)&&Mr(this.baseMutations,t.baseMutations,Ds)},pa),fa=(la.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=hu,i=t.mutations,o=0;o<i.length;o++)r=r.zt(i[o].key,n[o].version);return new la(t,e,n,r)},la);function la(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.Fs=r}function pa(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}function da(){this.ys=[]}function ya(t){var e=Wu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Wo(e,e.limit,"L"):e}var va=(wa.prototype.qs=function(t,e){return this.Bs.add(e),ra.resolve()},wa.prototype.Us=function(t,e){return ra.resolve(this.Bs.getEntries(e))},wa),ga=(ma.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new iu(hi.H),t=!r.has(n);return this.index[e]=r.add(n),t},ma.prototype.has=function(t){var e=t.tt(),t=t.X(),e=this.index[e];return e&&e.has(t)},ma.prototype.getEntries=function(t){return(this.index[t]||new iu(hi.H)).it()},ma);function ma(){this.index={}}function wa(){this.Bs=new ga}function ba(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Gr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function _a(t,e){this.progress=t,this.Go=e}var Ea=(ka.prototype.get=function(t){var e=this.ni(t),e=this.ii[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.si(o,t))return i}},ka.prototype.has=function(t){return void 0!==this.get(t)},ka.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},ka.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},ka.prototype.forEach=function(s){_i(this.ii,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ka.prototype.et=function(){return Ei(this.ii)},ka),Te=(Pa.prototype.ci=function(t){t=this.ri.get(t);return t?t.readTime:ci.min()},Pa.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},Pa.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},Pa.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?ra.resolve(n.hi):this.fi(t,e)},Pa.prototype.getEntries=function(t,e){return this.di(t,e)},Pa.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},Pa.prototype.ui=function(){},Pa),Ta=(Ra.prototype.next=function(){return this.Mi+=2,this.Mi},Ra.Li=function(){return new Ra(0)},Ra.$i=function(){return new Ra(-1)},Ra),Ia=(Ca.prototype.Ho=function(e,n){var r=this;return this.zo.bi(e,n).next(function(t){return r.Jo(e,n,t)})},Ca.prototype.Jo=function(t,r,i){return this.fo._i(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Cs(r,t);return t})},Ca.prototype.Yo=function(t,e,i){var o=su;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Cs(t,e);o=o.zt(t,e)}),o},Ca.prototype.Xo=function(e,t){var n=this;return this.fo.getEntries(e,t).next(function(t){return n.Zo(e,t)})},Ca.prototype.Zo=function(e,r){var i=this;return this.zo.vi(e,r).next(function(t){var t=i.Yo(e,r,t),n=su;return t.forEach(function(t,e){e=e||new $i(t,ci.min()),n=n.zt(t,e)}),n})},Ca.prototype.Kr=function(t,e,n){return r=e,pi.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):Yo(e)?this.ec(t,e,n):this.nc(t,e,n);var r},Ca.prototype.tc=function(t,e){return this.Ho(t,new pi(e)).next(function(t){var e=cu;return t instanceof Zi&&(e=e.zt(t.key,t)),e})},Ca.prototype.ec=function(n,r,i){var o=this,s=r.collectionGroup,u=cu;return this.Ei.Us(n,s).next(function(t){return ra.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Fo(t,null,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.nc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.zt(t,e)})})}).next(function(){return u})})},Ca.prototype.nc=function(e,n,t){var a,c,r=this;return this.fo.Kr(e,n,t).next(function(t){return a=t,r.zo.Di(e,n)}).next(function(t){return c=t,r.sc(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Os(s,a.get(u),r.vs);a=s instanceof Zi?a.zt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){$o(n,e)||(a=a.remove(t))}),a})},Ca.prototype.sc=function(t,e,n){for(var r=lu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Zi&&(c=c.zt(t,e))}),c})},Ca),Aa=(La.oc=function(t,e){for(var n=lu(),r=lu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new La(t,e.fromCache,n,r)},La),Na=(Da.prototype.cc=function(t){this.ac=t},Da.prototype.Kr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.xt.length||1===r.xt.length&&r.xt[0].field.ut())||i.isEqual(ci.min())?this.uc(e,r):this.ac.Xo(e,o).next(function(t){var n=s.hc(r,t);return(Go(r)||Bo(r))&&s.lc(r.limitType,n,o,i)?s.uc(e,r):(Or()<=u.DEBUG&&Dr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zo(r)),s.ac.Kr(e,r,i).next(function(e){return n.forEach(function(t){e=e.zt(t.key,t)}),e}))})},Da.prototype.hc=function(n,t){var r=new iu(ts(n));return t.forEach(function(t,e){e instanceof Zi&&$o(n,e)&&(r=r.add(e))}),r},Da.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version._(r))},Da.prototype.uc=function(t,e){return Or()<=u.DEBUG&&Dr("QueryEngine","Using full collection scan to execute query:",Zo(e)),this.ac.Kr(t,e,ci.min())},Da),Sa=(Oa.prototype.Ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Vr(t,n.fc)})},Oa);function Oa(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Js(Ur),this.dc=new Ea(so,uo),this.wc=ci.min(),this.zo=t.Qo(n),this.Ec=t.Fr(),this._o=t.Sr(),this.Tc=new Ia(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}function Da(){}function La(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}function Ca(t,e,n){this.fo=t,this.zo=e,this.Ei=n}function Ra(t){this.Mi=t}function Pa(){this.ri=new Ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}function ka(t,e){this.ni=t,this.si=e,this.ii={}}function Va(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).zo,m=e.Tc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.zo.pi(v).next(function(t){return g=t,n=e.persistence.Qo(o),m=new Ia(e.Ec,n,e.persistence.Ko()),n.pi(v)}).next(function(t){for(var e=[],n=[],r=lu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xo(v,r).next(function(t){return{Ic:t,mc:e,Ac:n}})})})];case 1:return r=t.sent(),[2,(e.zo=n,e.Tc=m,e._c.cc(e.Tc),r)]}})})}function xa(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ec.Nr({Wr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ra.resolve(),n.forEach(function(n){u=u.next(function(){return o._i(r,n)}).next(function(t){var e=t,t=i.Fs.get(n);kr(null!==t),(!e||e.version._(t)<0)&&(e=s.Ss(n,e,i))&&o.ai(e,i.Ns)})}),u.next(function(){return e.zo.Ci(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.zo.Fi(t)}).next(function(){return f.Tc.Xo(t,a)})})}function Ua(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function Ma(t,r){var a=t,c=r.kt,h=a.fc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Nr({Wr:!0});h=a.fc;var u=[];r.Fe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a._o.sr(s,t.Qe,e).next(function(){return a._o.er(s,t.qe,e)})),0<(i=t.resumeToken).l()&&(n=o.Lt(i,c).Mt(s.bs),h=h.zt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.l()),(0===r.resumeToken.l()||3e8<=o.kt.W()-r.kt.W()||0<i.qe.size+i.Ue.size+i.Qe.size)&&u.push(a._o.Hi(s,n))))});var e,n=su;return r.ke.forEach(function(t,e){r.Me.has(t)&&u.push(a.persistence.Ti.Or(s,t))}),u.push(ja(s,t,r.ke,c,void 0).next(function(t){n=t})),c.isEqual(ci.min())||(e=a._o.Qi(s).next(function(t){return a._o.Wi(s,s.bs,c)}),u.push(e)),ra.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Tc.Zo(s,n)})}).then(function(t){return a.fc=h,t})}function ja(t,s,e,u,a){var n=lu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=su;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof $i&&e.version.isEqual(ci.min())?(s.li(t,r),o=o.zt(t,e)):null==n||0<e.version._(n.version)||0===e.version._(n.version)&&n.hasPendingWrites?(s.ai(e,r),o=o.zt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Fa(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i._o.tr(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i._o.Bi(e).next(function(t){return n=new es(r,t,0,e.bs),i._o.ji(e,n).next(function(){return n})})})}).then(function(t){var e=i.fc.get(t.targetId);return(null===e||0<t.kt._(e.kt))&&(i.fc=i.fc.zt(t.targetId,t),i.dc.set(r,t.targetId)),t})}function qa(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).fc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ti.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!oa(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.fc=e.fc.remove(o),e.dc.delete(n.target),[2]}})})}function Ga(t,o,s){var u=t,a=ci.min(),c=lu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Xo(o),(void 0!==(t=(i=t).dc.get(r))?ra.resolve(i.fc.get(t)):i._o.tr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u._o.rr(e,t.targetId).next(function(t){c=t})}).next(function(){return u._c.Kr(e,o,s?a:ci.min(),s?c:lu())}).next(function(t){return{documents:t,Rc:c}});var t,n,r,i})}var Ba,za,Ha,Ya=(Ac.prototype.ks=function(t,e){return ra.resolve(this.Vc.get(e))},Ac.prototype.Ms=function(t,e){return this.Vc.set(e.id,{id:e.id,version:e.version,createTime:Mu(e.createTime)}),ra.resolve()},Ac.prototype.Ls=function(t,e){return ra.resolve(this.bc.get(e))},Ac.prototype.$s=function(t,e){return this.bc.set(e.name,{name:(e=e).name,query:ya(e.bundledQuery),readTime:Mu(e.readTime)}),ra.resolve()},Ac),Qa=(Ic.prototype.et=function(){return this.vc.et()},Ic.prototype.nr=function(t,e){e=new Xa(t,e);this.vc=this.vc.add(e),this.Dc=this.Dc.add(e)},Ic.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},Ic.prototype.ir=function(t,e){this.Nc(new Xa(t,e))},Ic.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},Ic.prototype.Oc=function(t){var e=this,n=new pi(new hi([])),r=new Xa(n,t),t=new Xa(n,t+1),i=[];return this.Dc.me([r,t],function(t){e.Nc(t),i.push(t.key)}),i},Ic.prototype.kc=function(){var e=this;this.vc.forEach(function(t){return e.Nc(t)})},Ic.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},Ic.prototype.Mc=function(t){var e=new pi(new hi([])),n=new Xa(e,t),t=new Xa(e,t+1),r=lu();return this.Dc.me([n,t],function(t){r=r.add(t.key)}),r},Ic.prototype.Oi=function(t){var e=new Xa(t,0),e=this.vc.Re(e);return null!==e&&t.isEqual(e.key)},Ic),Xa=(Tc.Sc=function(t,e){return pi.H(t.key,e.key)||Ur(t.Lc,e.Lc)},Tc.Cc=function(t,e){return Ur(t.Lc,e.Lc)||pi.H(t.key,e.key)},Tc),Wa=(Ec.prototype.Ai=function(t){return ra.resolve(0===this.zo.length)},Ec.prototype.Ri=function(t,e,n,r){var i=this.$c;this.$c++,0<this.zo.length&&this.zo[this.zo.length-1];n=new ha(i,e,n,r);this.zo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Bc=this.Bc.add(new Xa(u.key,i)),this.Ei.qs(t,u.key.path.X())}return ra.resolve(n)},Ec.prototype.Pi=function(t,e){return ra.resolve(this.qc(e))},Ec.prototype.gi=function(t,e){e+=1,e=this.Uc(e),e=e<0?0:e;return ra.resolve(this.zo.length>e?this.zo[e]:null)},Ec.prototype.Vi=function(){return ra.resolve(0===this.zo.length?-1:this.$c-1)},Ec.prototype.pi=function(t){return ra.resolve(this.zo.slice())},Ec.prototype.bi=function(t,e){var n=this,r=new Xa(e,0),e=new Xa(e,Number.POSITIVE_INFINITY),i=[];return this.Bc.me([r,e],function(t){t=n.qc(t.Lc);i.push(t)}),ra.resolve(i)},Ec.prototype.vi=function(t,e){var n=this,r=new iu(Ur);return e.forEach(function(t){var e=new Xa(t,0),t=new Xa(t,Number.POSITIVE_INFINITY);n.Bc.me([e,t],function(t){r=r.add(t.Lc)})}),ra.resolve(this.Qc(r))},Ec.prototype.Di=function(t,e){var n=e.path,r=n.length+1,e=n;pi.wt(e)||(e=e.child(""));var e=new Xa(new pi(e),0),i=new iu(Ur);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),ra.resolve(this.Qc(i))},Ec.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.qc(t);null!==t&&n.push(t)}),n},Ec.prototype.Ci=function(n,r){var i=this;kr(0===this.Kc(r.batchId,"removed")),this.zo.shift();var o=this.Bc;return ra.forEach(r.mutations,function(t){var e=new Xa(t.key,r.batchId);return o=o.delete(e),i.Ti.Ni(n,t.key)}).next(function(){i.Bc=o})},Ec.prototype.xi=function(t){},Ec.prototype.Oi=function(t,e){var n=new Xa(e,0),n=this.Bc.Re(n);return ra.resolve(e.isEqual(n&&n.key))},Ec.prototype.Fi=function(t){return this.zo.length,ra.resolve()},Ec.prototype.Kc=function(t,e){return this.Uc(t)},Ec.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},Ec.prototype.qc=function(t){t=this.Uc(t);return t<0||t>=this.zo.length?null:this.zo[t]},Ec),Ka=(_c.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:i,readTime:n}),this.size+=i-o,this.Ei.qs(t,r.path.X())},_c.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},_c.prototype._i=function(t,e){e=this.docs.get(e);return ra.resolve(e?e.hi:null)},_c.prototype.getEntries=function(t,e){var n=this,r=su;return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),ra.resolve(r)},_c.prototype.Kr=function(t,e,n){for(var r=cu,i=new pi(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,s=a.hi,a=a.readTime;if(!e.path.nt(u.path))break;a._(n)<=0||s instanceof Zi&&$o(e,s)&&(r=r.zt(s.key,s))}return ra.resolve(r)},_c.prototype.jc=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},_c.prototype.Nr=function(t){return new Ja(this)},_c.prototype.kr=function(t){return ra.resolve(this.size)},_c),Ja=(f(bc,Ha=Te),bc.prototype.wi=function(n){var r=this,i=[];return this.ri.forEach(function(t,e){e&&e.hi?i.push(r.jr.ai(n,e.hi,r.ci(t))):r.jr.li(t)}),ra.Ln(i)},bc.prototype.fi=function(t,e){return this.jr._i(t,e)},bc.prototype.di=function(t,e){return this.jr.getEntries(t,e)},bc),Za=(wc.prototype.In=function(t,n){return this.Gc.forEach(function(t,e){return n(e)}),ra.resolve()},wc.prototype.Qi=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},wc.prototype.Ki=function(t){return ra.resolve(this.zc)},wc.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),ra.resolve(this.highestTargetId)},wc.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),ra.resolve()},wc.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Ta(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},wc.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,ra.resolve()},wc.prototype.Hi=function(t,e){return this.Gi(e),ra.resolve()},wc.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Oc(e.targetId),--this.targetCount,ra.resolve()},wc.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return this.Gc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gc.delete(t),u.push(o.Yi(n,e.targetId)),s++)}),ra.Ln(u).next(function(){return s})},wc.prototype.Zi=function(t){return ra.resolve(this.targetCount)},wc.prototype.tr=function(t,e){e=this.Gc.get(e)||null;return ra.resolve(e)},wc.prototype.er=function(t,e,n){return this.Hc.xc(e,n),ra.resolve()},wc.prototype.sr=function(e,t,n){this.Hc.Fc(t,n);var r=this.persistence.Ti,i=[];return r&&t.forEach(function(t){i.push(r.Ni(e,t))}),ra.Ln(i)},wc.prototype.Yi=function(t,e){return this.Hc.Oc(e),ra.resolve()},wc.prototype.rr=function(t,e){e=this.Hc.Mc(e);return ra.resolve(e)},wc.prototype.Oi=function(t,e){return ra.resolve(this.Hc.Oi(e))},wc),$a=(mc.prototype.start=function(){return Promise.resolve()},mc.prototype.Mo=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(mc.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),mc.prototype.Po=function(){},mc.prototype.yo=function(){},mc.prototype.Ko=function(){return this.Ei},mc.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Wa(this.Ei,this.Ti),this.Yc[t.A()]=e),e},mc.prototype.Sr=function(){return this._o},mc.prototype.Fr=function(){return this.fo},mc.prototype.Wo=function(){return this.wo},mc.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new tc(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).kn().then(function(t){return i.Vs(),t})},mc.prototype.ea=function(e,n){return ra.$n(Object.values(this.Yc).map(function(t){return function(){return t.Oi(e,n)}}))},mc),tc=(f(gc,za=o),gc),ec=(vc.ia=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Pr()},enumerable:!1,configurable:!0}),vc.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),ra.resolve()},vc.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),ra.resolve()},vc.prototype.Ni=function(t,e){return this.ra.add(e.toString()),ra.resolve()},vc.prototype.removeTarget=function(t,e){var n=this;this.na.Oc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},vc.prototype.Zc=function(){this.sa=new Set},vc.prototype.ta=function(n){var r=this,i=this.persistence.Fr().Nr();return ra.forEach(this.ra,function(t){var e=pi._t(t);return r.oa(n,e).next(function(t){t||i.li(e)})}).next(function(){return r.sa=null,i.apply(n)})},vc.prototype.Or=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},vc.prototype.Xc=function(t){return 0},vc.prototype.oa=function(t,e){var n=this;return ra.$n([function(){return ra.resolve(n.na.Oi(e))},function(){return n.persistence.Sr().Oi(t,e)},function(){return n.persistence.ea(t,e)}])},vc),nc=(yc.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},yc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},yc.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},yc),rc=(dc.prototype.Ca=function(t){},dc.prototype.Na=function(t,e,n){},dc.prototype.Oa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},dc.prototype.Ba=function(t,e,n){this.ru[t]=e},dc.prototype.Ma=function(t){this.iu.ha(t)},dc.prototype.La=function(t){return this.iu.activeTargetIds.has(t)},dc.prototype.$a=function(t){delete this.ru[t]},dc.prototype.va=function(){return this.iu.activeTargetIds},dc.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},dc.prototype.start=function(){return this.iu=new nc,Promise.resolve()},dc.prototype.Ua=function(t,e,n){},dc.prototype.Qa=function(t){},dc.prototype.Mo=function(){},dc.prototype.B=function(t){},dc.prototype.Wa=function(){},dc),ic=(pc.prototype.ou=function(t){},pc.prototype.Mo=function(){},pc),oc=(lc.prototype.ou=function(t){this.lu.push(t)},lc.prototype.Mo=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},lc.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},lc.prototype.au=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},lc.prototype.hu=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},lc.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},lc),sc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},uc=(fc.prototype.wu=function(t){this.Eu=t},fc.prototype.Tu=function(t){this.Iu=t},fc.prototype.onMessage=function(t){this.mu=t},fc.prototype.close=function(){this.du()},fc.prototype.send=function(t){this.fu(t)},fc.prototype.Au=function(){this.Eu()},fc.prototype.Ru=function(t){this.Iu(t)},fc.prototype.Pu=function(t){this.mu(t)},fc),ac=(hc.prototype.pu=function(e,t,n,r){var i=this.bu(e,t);Dr("RestConnection","Sending: ",i,n);t={};return this.vu(t,r),this.Su(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw Cr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},hc.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},hc.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.6",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},hc.prototype.bu=function(t,e){t=sc[t];return this.gu+"/v1/"+e+":"+t},f(cc,Ba=hc),cc.prototype.Su=function(o,e,s,u){return new Promise(function(n,r){var i=new Tr;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new Br(Gr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Gr).indexOf(e)?e:Gr.UNKNOWN,r(new Br(e,t.message))):r(new Br(Gr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Br(Gr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},cc.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Dr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new uc({fu:function(t){a?Dr("Connection","Not sending because WebChannel is closed:",t):(u||(Dr("Connection","Opening WebChannel transport."),s.open(),u=!0),Dr("Connection","WebChannel sending:",t),s.send(t))},du:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Er.EventType.OPEN,function(){a||Dr("Connection","WebChannel transport opened.")}),t(s,Er.EventType.CLOSE,function(){a||(a=!0,Dr("Connection","WebChannel transport closed"),c.Ru())}),t(s,Er.EventType.ERROR,function(t){a||(a=!0,Cr("Connection","WebChannel transport errored:",t),c.Ru(new Br(Gr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Er.EventType.MESSAGE,function(t){var e,n,r,i;a||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gs[r];if(void 0!==t)return Ks(t)}(),i=n.message,void 0===t&&(t=Gr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Ru(new Br(t,i)),s.close()):(Dr("Connection","WebChannel received:",e),c.Pu(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Dr("Connection","Detected buffering proxy"):t.stat===_r&&Dr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Au()},0),c},cc);function cc(t){var e=this;return(e=Ba.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function hc(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function fc(t){this.fu=t.fu,this.du=t.du}function lc(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}function pc(){}function dc(){this.iu=new nc,this.ru={},this.fa=null,this.M=null}function yc(){this.activeTargetIds=pu}function vc(t){this.persistence=t,this.na=new Qa,this.sa=null}function gc(t){var e=this;return(e=za.call(this)||this).bs=t,e}function mc(t,e){var n=this;this.Yc={},this.so=new ti(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Za(this),this.Ei=new va,this.fo=(t=this.Ei,new Ka(t,function(t){return n.Ti.Xc(t)})),this.Qt=new ca(e),this.wo=new Ya(this.Qt)}function wc(t){this.persistence=t,this.Gc=new Ea(so,uo),this.lastRemoteSnapshotVersion=ci.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Qa,this.targetCount=0,this.Jc=Ta.Li()}function bc(t){var e=this;return(e=Ha.call(this)||this).jr=t,e}function _c(t,e){this.Ei=t,this.Wc=e,this.docs=new Js(pi.H),this.size=0}function Ec(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.$c=1,this.Bc=new iu(Xa.Sc)}function Tc(t,e){this.key=t,this.Lc=e}function Ic(){this.vc=new iu(Xa.Sc),this.Dc=new iu(Xa.Cc)}function Ac(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}function Nc(){return"undefined"!=typeof document?document:null}function Sc(t){return new Vu(t,!0)}function Oc(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.Fh=[],this.Oh=i,this.Oh.ou(function(t){n.Ps(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Jc(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(4),[4,zc(e)];case 1:return t.sent(),e.kh.set("Unknown"),e.Nh.delete(4),[4,Bc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.kh=new xc(n,r)}var Dc,Lc,Cc,Rc=(Gc.prototype.reset=function(){this.Ou=0},Gc.prototype.Lu=function(){this.Ou=this.Fu},Gc.prototype.$u=function(t){var e=this;this.cancel();var n=Math.floor(this.Ou+this.Bu()),r=Math.max(0,Date.now()-this.Mu),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ou+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ku=this.Zr.Tr(this.fs,i,function(){return e.Mu=Date.now(),t()}),this.Ou*=this.Nu,this.Ou<this.xu&&(this.Ou=this.xu),this.Ou>this.Fu&&(this.Ou=this.Fu)},Gc.prototype.qu=function(){null!==this.ku&&(this.ku.Rs(),this.ku=null)},Gc.prototype.cancel=function(){null!==this.ku&&(this.ku.cancel(),this.ku=null)},Gc.prototype.Bu=function(){return(Math.random()-.5)*this.Ou},Gc),Te=(qc.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},qc.prototype.Hu=function(){return 2===this.state},qc.prototype.start=function(){3!==this.state?this.auth():this.Ju()},qc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},qc.prototype.Yu=function(){this.state=0,this.Gu.reset()},qc.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},qc.prototype.th=function(t){this.eh(),this.stream.send(t)},qc.prototype.Zu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},qc.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},qc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==e?this.Gu.reset():n&&n.code===Gr.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Lu()):n&&n.code===Gr.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},qc.prototype.nh=function(){},qc.prototype.auth=function(){var n=this;this.state=1;var t=this.sh(this.Wu),e=this.Wu;this.Ku.getToken().then(function(t){n.Wu===e&&n.ih(t)},function(e){t(function(){var t=new Br(Gr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.rh(t)})})},qc.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},qc.prototype.Ju=function(){var t=this;this.state=4,this.Gu.$u(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},qc.prototype.rh=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},qc.prototype.sh=function(e){var n=this;return function(t){n.Zr.Ps(function(){return n.Wu===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},qc),Pc=(f(Fc,Cc=Te),Fc.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},Fc.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.Bt?(kr(void 0===s||"string"==typeof s),jr.fromBase64String(s||"")):(kr(void 0===s||s instanceof Uint8Array),jr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Gr.UNKNOWN:Ks(c.code),new Br(a,c.message||"")),s=new _u(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Gu(t,n.document.name),i=Mu(n.document.updateTime);var u=new Hi({mapValue:{fields:n.document.fields}}),a=(o=new Zi(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new wu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Gu(t,n.document),i=n.readTime?Mu(n.readTime):ci.min(),u=new $i(r,i),o=n.removedTargetIds||[],s=new wu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Gu(t,n.document),i=n.removedTargetIds||[],s=new wu([],i,r,null);else{if(!("filter"in e))return Pr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new qs(n),i=e.targetId,s=new bu(i,r)}return s}(this.Qt,t),t=function(t){if(!("targetChange"in t))return ci.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Mu(t.readTime):ci.min()}(t);return this.listener.ah(e,t)},Fc.prototype.uh=function(t){var e,n,r,i={};i.database=zu(this.Qt),i.addTarget=(e=this.Qt,(r=ao(r=(n=t).target)?{documents:{documents:[Bu(e,r.path)]}}:{query:Xu(e,r)}).targetId=n.targetId,0<n.resumeToken.l()?r.resumeToken=Uu(e,n.resumeToken):0<n.kt._(ci.min())&&(r.readTime=xu(e,n.kt.j())),r);var o,t=(this.Qt,o=t,null==(t=function(){switch(o.Ot){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.th(i)},Fc.prototype.hh=function(t){var e={};e.database=zu(this.Qt),e.removeTarget=t,this.th(e)},Fc),kc=(f(jc,Lc=Te),Object.defineProperty(jc.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),jc.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,Lc.prototype.start.call(this)},jc.prototype.nh=function(){this.lh&&this.fh([])},jc.prototype.oh=function(t){return this.Qu.Cu("Write",t)},jc.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(kr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Mu(t.updateTime):Mu(e);n.isEqual(ci.min())&&(n=Mu(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Is(n,e)}(t,r)})):[]),n=Mu(t.commitTime);return this.listener.dh(n,e)}var n,r;return kr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},jc.prototype.Eh=function(){var t={};t.database=zu(this.Qt),this.th(t)},jc.prototype.fh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qu(e.Qt,t)})};this.th(t)},jc),Vc=(f(Mc,Dc=function(){}),Mc.prototype.Ih=function(){if(this.Th)throw new Br(Gr.FAILED_PRECONDITION,"The client has already been terminated.")},Mc.prototype.pu=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.pu(e,n,r,t)}).catch(function(t){throw t.code===Gr.UNAUTHENTICATED&&i.credentials.p(),t})},Mc.prototype.Du=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.Du(e,n,r,t)}).catch(function(t){throw t.code===Gr.UNAUTHENTICATED&&i.credentials.p(),t})},Mc.prototype.terminate=function(){this.Th=!1},Mc),xc=(Uc.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},Uc.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},Uc.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},Uc.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},Uc.prototype.gh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(Lr(t),this.Rh=!1):Dr("OnlineStateTracker",t)},Uc.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},Uc);function Uc(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}function Mc(t,e,n){var r=this;return(r=Dc.call(this)||this).credentials=t,r.Qu=e,r.Qt=n,r.Th=!1,r}function jc(t,e,n,r,i){var o=this;return(o=Lc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Qt=r,o.lh=!1,o}function Fc(t,e,n,r,i){var o=this;return(o=Cc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Qt=r,o}function qc(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Rc(t,e)}function Gc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.Fu=i,this.Ou=0,this.ku=null,this.Mu=Date.now(),this.reset()}function Bc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Jc(r))return[3,4];e=0,n=r.Fh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function zc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Fh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Hc(t,e){t.xh.has(e.targetId)||(t.xh.set(e.targetId,e),Kc(t)?Wc(t):oh(t).Hu()&&Qc(t,e))}function Yc(t,e){var n=t,t=oh(n);n.xh.delete(e),t.Hu()&&Xc(n,e),0===n.xh.size&&(t.Hu()?t.Xu():Jc(n)&&n.kh.set("Unknown"))}function Qc(t,e){t.Mh.on(e.targetId),oh(t).uh(e)}function Xc(t,e){t.Mh.on(e),oh(t).hh(e)}function Wc(e){e.Mh=new Tu({vn:function(t){return e.Dh.vn(t)},Sn:function(t){return e.xh.get(t)||null}}),oh(e).start(),e.kh.Ph()}function Kc(t){return Jc(t)&&!oh(t).zu()&&0<t.xh.size}function Jc(t){return 0===t.Nh.size}function Zc(t){t.Mh=void 0}function $c(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.kh.set("Online"),!(u instanceof _u&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.xh.has(i)?[4,o.Dh.Lh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.xh.delete(i),o.Mh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,th(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof wu?s.Mh.dn(u):u instanceof bu?s.Mh.Pn(u):s.Mh.Tn(u),a.isEqual(ci.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ua(s.bh)];case 8:return o=t.sent(),0<=a._(o)?[4,(i=a,(e=(r=s).Mh.Vn(i)).Fe.forEach(function(t,e){var n;0<t.resumeToken.l()&&((n=r.xh.get(e))&&r.xh.set(e,n.Lt(t.resumeToken,i)))}),e.Oe.forEach(function(t){var e=r.xh.get(t);e&&(r.xh.set(t,e.Lt(jr.T,e.kt)),Xc(r,t),e=new es(e.target,t,1,e.sequenceNumber),Qc(r,e))}),r.Dh.$h(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,th(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function th(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!oa(r))throw r;return n.Nh.add(1),[4,zc(n)];case 1:return t.sent(),n.kh.set("Offline"),i=i||function(){return Ua(n.bh)},n._s.po(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Nh.delete(1),[4,Bc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function eh(e,n){return n().catch(function(t){return th(e,t,n)})}function nh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=sh(i=a),s=0<i.Ch.length?i.Ch[i.Ch.length-1].batchId:-1,t.label=1;case 1:if(!(Jc(i)&&i.Ch.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.bh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.zo.gi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Ch.length&&o.Xu(),[3,7]):(s=u.batchId,function(t,e){t.Ch.push(e);t=sh(t);t.Hu()&&t._h&&t.fh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,th(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return rh(i)&&ih(i),[2]}var e,n,r})})}function rh(t){return Jc(t)&&!sh(t).zu()&&0<t.Ch.length}function ih(t){sh(t).start()}function oh(n){var t,e,r,i=this;return n.Uh||(n.Uh=(t=n.Sh,e=n._s,r={wu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.xh.forEach(function(t,e){Qc(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Zc(e),Kc(e)?(e.kh.Vh(n),Wc(e)):e.kh.set("Unknown"),[2]})})}.bind(null,n),ah:$c.bind(null,n)},t.Ih(),new Pc(e,t.Qu,t.credentials,t.Qt,r)),n.Fh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Uh.Yu(),Kc(n)?Wc(n):n.kh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Uh.stop()];case 2:t.sent(),Zc(n),t.label=3;case 3:return[2]}})})})),n.Uh}function sh(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Sh,e=n._s,r={wu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return sh(e).Eh(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&sh(e)._h?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ws(n=i.code)&&n!==Gr.ABORTED?(e=r.Ch.shift(),sh(r).Yu(),[4,eh(r,function(){return r.Dh.qh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,nh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return rh(e)&&ih(e),[2]}})})}.bind(null,n),wh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=sh(o),n=0,r=o.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]})})}.bind(null,n),dh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ch.shift(),n=fa.from(e,i,o),[4,eh(r,function(){return r.Dh.Bh(n)})];case 1:return t.sent(),[4,nh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ih(),new kc(e,t.Qu,t.credentials,t.Qt,r)),n.Fh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Yu(),[4,nh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qh.stop()];case 3:t.sent(),0<n.Ch.length&&(Dr("RemoteStore","Stopping write stream with "+n.Ch.length+" pending writes"),n.Ch=[]),t.label=4;case 4:return[2]}})})})),n.Qh}function uh(){this.queries=new Ea(Jo,Ko),this.onlineState="Unknown",this.Wh=new Set}var ah=function(){this.Kh=void 0,this.listeners=[]};function ch(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ah),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.jh(n)];case 2:return o.Kh=t.sent(),[3,4];case 3:return o=t.sent(),o=aa(o,"Initialization of query '"+Zo(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Gh(e.onlineState),i.Kh&&u.zh(i.Kh)&&fh(e),[2]}})})}function hh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Hh(n))]:[2]})})}function fh(t){t.Wh.forEach(function(t){t.next()})}var lh=(wh.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},wh.prototype.onError=function(t){this.Jh.error(t)},wh.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},wh.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},wh.prototype.Zh=function(t){if(0<t.docChanges.length)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},wh.prototype.el=function(t){t=vu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},wh),ph=(mh.prototype.sl=function(){return"metadata"in this.payload},mh),dh=(gh.prototype.Pc=function(t){return Gu(this.Qt,t)},gh.prototype.yc=function(t){return t.metadata.exists?(e=this.Qt,n=t.document,r=Gu(e,n.name),e=Mu(n.updateTime),n=new Hi({mapValue:{fields:n.fields}}),new Zi(r,e,n,{hasCommittedMutations:!1})):new $i(this.Pc(t.metadata.name),this.gc(t.metadata.readTime));var e,n,r},gh.prototype.gc=Mu,gh),yh=(vh.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},vh.prototype.ol=function(t){for(var e=new Map,n=new dh(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||lu()).add(s);e.set(c,h)}}return e},vh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=lu(),i=su,o=hu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Pc(u.metadata.name),u.document&&(r=r.add(a)),i=i.zt(a,l.yc(u)),o=o.zt(a,l.gc(u.metadata.readTime));return c=n.Ec.Nr({Wr:!0}),[4,Fa(n,Xo(qo(hi.ot("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return ja(e,c,i,ci.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n._o.Yi(e,h.targetId).next(function(){return n._o.er(e,r,h.targetId)}).next(function(){return n.Tc.Zo(e,t)})})})]}})})}(this.bh,new dh(this.Qt),this.documents,this.il.id)];case 1:e=t.sent(),n=this.ol(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=lu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Fa(e,Xo(ya(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Mu(i.readTime);if(0<=n.kt._(e))return r.wo.$s(t,i);e=n.Lt(jr.T,e);return r.fc=r.fc.zt(e.targetId,e),r._o.Hi(t,e).next(function(){return r._o.Yi(t,n.targetId)}).next(function(){return r._o.er(t,o,n.targetId)}).next(function(){return r.wo.$s(t,i)})})]}})})}(this.bh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new _a(Object.assign({},this.progress),e))]}})})},vh);function vh(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=bh(t)}function gh(t){this.Qt=t}function mh(t,e){this.payload=t,this.byteLength=e}function wh(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}function bh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var _h=function(t){this.key=t},Eh=function(t){this.key=t},Th=(Object.defineProperty(Oh.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),Oh.prototype.fl=function(t,e){var s=this,u=e?e.dl:new yu,a=(e||this).ll,c=(e||this).De,h=a,f=!1,l=Go(this.query)&&a.size===this.query.limit?a.last():null,p=Bo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Xt(function(t,e){var n=a.get(t),r=(r=e instanceof Zi?e:null)&&($o(s.query,r)?r:null),i=!!n&&s.De.has(n.key),o=!!r&&(r.Vt||s.De.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.hl(r,l)||p&&s.hl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Go(this.query)||Bo(this.query))for(;h.size>this.query.limit;){var n=Go(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ll:h,dl:u,lc:f,De:c}},Oh.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},Oh.prototype.wi=function(t,e,n){var o=this,r=this.ll;this.ll=t.ll,this.De=t.De;var i=t.dl.ve();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.hl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.El(n);var s=e?this.Tl():[],n=0===this.ul.size&&this.Be?1:0,e=n!==this.al;return this.al=n,0!==i.length||e?{snapshot:new vu(this.query,t.ll,r,i,t.De,0==n,e,!1),Il:s}:{Il:s}},Oh.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new yu,De:this.De,lc:!1},!1)):{Il:[]}},Oh.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},Oh.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},Oh.prototype.Tl=function(){var e=this;if(!this.Be)return[];var n=this.ul;this.ul=lu(),this.ll.forEach(function(t){e.ml(t.key)&&(e.ul=e.ul.add(t.key))});var r=[];return n.forEach(function(t){e.ul.has(t)||r.push(new Eh(t))}),this.ul.forEach(function(t){n.has(t)||r.push(new _h(t))}),r},Oh.prototype.Al=function(t){this.cl=t.Rc,this.ul=lu();t=this.fl(t.documents);return this.wi(t,!0)},Oh.prototype.Rl=function(){return vu.Ne(this.query,this.ll,this.De,0===this.al)},Oh),Ih=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ah=function(t){this.key=t,this.Pl=!1},Nh=(Object.defineProperty(Sh.prototype,"Ll",{get:function(){return!0===this.Ml},enumerable:!1,configurable:!0}),Sh);function Sh(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Ea(Jo,Ko),this.Sl=new Map,this.Dl=[],this.Cl=new Js(pi.H),this.xl=new Map,this.Nl=new Qa,this.Fl={},this.Ol=new Map,this.kl=Ta.$i(),this.onlineState="Unknown",this.Ml=void 0}function Oh(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=lu(),this.De=lu(),this.hl=ts(t),this.ll=new du(this.hl)}function Dh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).yl.Dh.$h=Ch.bind(null,e),e.yl.Dh.vn=function(t,e){var n=t,t=n.xl.get(e);if(t&&t.Pl)return lu().add(t.key);var r=lu(),e=n.Sl.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.vl.get(s);r=r.Pe(s.view._l)}return r}.bind(null,e),e.yl.Dh.Lh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vl.Ba(s,"rejected",u),i=e.xl.get(s),(n=i&&i.key)?(r=(r=new Js(pi.H)).zt(n,new $i(n,ci.min())),i=lu().add(n),i=new gu(ci.min(),new Map,new iu(Ur),r,i),[4,Ch(e,i)]):[3,2];case 1:return t.sent(),e.Cl=e.Cl.remove(n),e.xl.delete(s),jh(e),[3,4];case 2:return[4,qa(e.bh,s,!1).then(function(){return xh(e,s,u)}).catch(ba)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.bl.ah=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&fh(n)}.bind(null,e.gl),e.bl.Bl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.gl),(s=(n=e).vl.get(a))?(r=s.targetId,n.Vl.Oa(r),i=s.view.Rl(),[3,4]):[3,1];case 1:return[4,Fa(n.bh,Xo(a))];case 2:return o=t.sent(),s=n.Vl.Oa(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.$l=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fl(o)).lc?[4,Ga(r.bh,i.query,!1).then(function(t){t=t.documents;return i.view.fl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Fe.get(i.targetId),n=i.view.wi(e,r.Ll,n),[2,(Mh(r,i.targetId,n.Il),n.snapshot)]}})})}(i,t,e,n)},[4,Ga(i.bh,o,!0)];case 1:return n=t.sent(),r=new Th(o,n.Rc),e=r.fl(n.documents),n=mu.$e(s,u&&"Offline"!==i.onlineState),n=r.wi(e,i.Ll,n),Mh(i,s,n.Il),r=new Ih(o,s,r),[2,(i.vl.set(o,r),i.Sl.has(s)?i.Sl.get(s).push(o):i.Sl.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.Ll&&Hc(n.yl,o),t.label=4;case 4:return[2,i]}var e})})}function Lh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).yl.Dh.Bh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,xa(e.bh,o)];case 2:return r=t.sent(),Vh(e,n,null),kh(e,n),e.Vl.Na(n,"acknowledged"),[4,Fh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.yl.Dh.qh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zo.Pi(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.zo.Ci(e,t)}).next(function(){return i.zo.Fi(e)}).next(function(){return i.Tc.Xo(e,n)})}))];case 2:return o=t.sent(),Vh(n,u,a),kh(n,u),n.Vl.Na(u,"rejected",a),[4,Fh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.bh,a=p,h=r,f=ai.now(),i=a.reduce(function(t,e){return t.add(e.key)},lu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Tc.Xo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Zi?e.field(o.field):void 0,s=ss(o.transform,s||null);null!=s&&(n=(null==n?new Yi:n).set(o.field,s))}return n?n.Pt():null}(e.fieldTransforms,s));null!=s&&n.push(new ks(o.key,s,function s(t){var u=[];return _i(t.fields||{},function(t,e){var n=new li([t]);if(zi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ti(u)}(s.proto.mapValue),As.exists(!0)))}return h.zo.Ri(u,f,n,a)})}).then(function(t){var e=t.xs(c);return{batchId:t.batchId,ri:e}}))];case 2:return s=t.sent(),u.Vl.Ca(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Fl[e.currentUser.A()])||new Js(Ur)).zt(n,o),e.Fl[e.currentUser.A()]=r,[4,Fh(u,s.ri)];case 3:return t.sent(),[4,nh(u.yl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=aa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Ch(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ma(n.bh,i)];case 2:return e=t.sent(),i.Fe.forEach(function(t,e){e=n.xl.get(e);e&&(kr(t.qe.size+t.Ue.size+t.Qe.size<=1),0<t.qe.size?e.Pl=!0:0<t.Ue.size?kr(e.Pl):0<t.Qe.size&&(kr(e.Pl),e.Pl=!1))}),[4,Fh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Rh(t,n,e){var r,t=t;(t.Ll&&0===e||!t.Ll&&1===e)&&(r=[],t.vl.forEach(function(t,e){e=e.view.Gh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Gh(i)&&(o=!0)}),o&&fh(t)}(t.gl,n),r.length&&t.bl.ah(r),t.onlineState=n,t.Ll&&t.Vl.Qa(n))}function Ph(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Jc((n=o).yl)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.bh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zo.Vi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Ol.get(r)||[]).push(s),n.Ol.set(r,i),[3,4]);case 3:return i=t.sent(),i=aa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function kh(t,e){(t.Ol.get(e)||[]).forEach(function(t){t.resolve()}),t.Ol.delete(e)}function Vh(t,e,n){var r=t,i=r.Fl[r.currentUser.A()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Fl[r.currentUser.A()]=i)}function xh(e,t,n){void 0===n&&(n=null),e.Vl.Ma(t);for(var r=0,i=e.Sl.get(t);r<i.length;r++){var o=i[r];e.vl.delete(o),n&&e.bl.Bl(o,n)}e.Sl.delete(t),e.Ll&&e.Nl.Oc(t).forEach(function(t){e.Nl.Oi(t)||Uh(e,t)})}function Uh(t,e){var n=t.Cl.get(e);null!==n&&(Yc(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),jh(t))}function Mh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof _h?(t.Nl.nr(o.key,e),function(t,e){e=e.key;t.Cl.get(e)||(Dr("SyncEngine","New document in limbo: "+e),t.Dl.push(e),jh(t))}(t,o)):o instanceof Eh?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Oi(o.key)||Uh(t,o.key)):Pr()}}function jh(t){for(;0<t.Dl.length&&t.Cl.size<t.pl;){var e=t.Dl.shift(),n=t.kl.next();t.xl.set(n,new Ah(e)),t.Cl=t.Cl.zt(e,n),Hc(t.yl,new es(Xo(qo(e.path)),n,2,ti.q))}}function Fh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vl.et()?[3,3]:(n.vl.forEach(function(t,e){o.push(n.$l(e,s,u).then(function(t){t&&(n.Ll&&n.Vl.Ba(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Aa.oc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bl.ah(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(c,function(e){return ra.forEach(e.ic,function(t){return r.persistence.Ti.nr(n,e.targetId,t)}).next(function(){return ra.forEach(e.rc,function(t){return r.persistence.Ti.ir(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.fc.get(o),u=s.kt,u=s.$t(u),r.fc=r.fc.zt(o,u));return[2]}})})}(n.bh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function qh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.A()),[4,Va(n.bh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Ol.forEach(function(t){t.forEach(function(t){t.reject(new Br(Gr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ol.clear(),n.Vl.Ua(o,r.mc,r.Ac),[4,Fh(n,r.Ic)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Gh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.bh,o=r,s=Mu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.wo.ks(t,i.id)}).then(function(t){return!!t&&0<=t.createTime._(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.ql({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ul(bh(u)),a=new yh(u,l.bh,p.Qt),[4,p.Ql()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.rl(c)]:[3,10];case 7:return(h=t.sent())&&d.Ul(h),[4,p.Ql()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Fh(l,f.Go,void 0)];case 12:return t.sent(),[4,(r=l.bh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.wo.Ms(t,e)}))];case 13:return t.sent(),d.ql(f.progress),[3,15];case 14:return Cr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Kl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Vl.Wa()})}var Bh=(Yh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qt=Sc(e.yu.t),this.Vl=this.Wl(e),this.persistence=this.jl(e),[4,this.persistence.start()];case 1:return t.sent(),this.Gl=this.zl(e),this.bh=this.Hl(e),[2]}})})},Yh.prototype.zl=function(t){return null},Yh.prototype.Hl=function(t){return e=this.persistence,n=new Na,r=t.Jl,t=this.Qt,new Sa(e,n,r,t);var e,n,r},Yh.prototype.jl=function(t){return new $a(ec.ia,this.Qt)},Yh.prototype.Wl=function(t){return new rc},Yh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.Mo()];case 1:return t.sent(),[4,this.persistence.Mo()];case 2:return t.sent(),[2]}})})},Yh),zh=(Hh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.bh?[3,2]:(this.bh=n.bh,this.Vl=n.Vl,this.Sh=this.Xl(r),this.yl=this.Zl(r),this.gl=this.t_(r),this._a=this.e_(r,!n.synchronizeTabs),this.Vl.fa=function(t){return Rh(e._a,t,1)},this.yl.Dh.n_=qh.bind(null,this._a),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Nh.delete(2),[4,Bc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Nh.add(2),[4,zc(e)]);case 3:t.sent(),e.kh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.yl,this._a.Ll)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Hh.prototype.t_=function(t){return new uh},Hh.prototype.Xl=function(t){var e=Sc(t.yu.t),n=(n=t.yu,new ac(n));return t=t.credentials,new Vc(t,n,e)},Hh.prototype.Zl=function(t){var e=this,n=this.bh,r=this.Sh,i=t._s,o=function(t){return Rh(e._a,t,0)},t=new(oc.Kn()?oc:ic);return new Oc(n,r,i,o,t)},Hh.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){o=new Nh(t,e,n,r,i,o);return s&&(o.Ml=!0),o}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},Hh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,zc(e)];case 1:return t.sent(),e.Oh.Mo(),e.kh.set("Unknown"),[2]}})})}(this.yl)},Hh);function Hh(){}function Yh(){this.synchronizeTabs=!1}function Qh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var Xh=(ef.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},ef.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ef.prototype.i_=function(){this.muted=!0},ef.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ef),Wh=(tf.prototype.close=function(){return this.r_.cancel()},tf.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},tf.prototype.Ql=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},tf.prototype.c_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.a_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.o_.decode(e),n=Number(r),isNaN(n)&&this.u_("length string ("+r+") is not valid number"),[4,this.h_(n)]);case 2:return r=t.sent(),[2,new ph(JSON.parse(r),e.length+n)]}})})},tf.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},tf.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},tf.prototype.h_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.__()]:[3,3];case 1:t.sent()&&this.u_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},tf.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},tf.prototype.__=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.r_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},tf),Kh=($h.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},$h),Jh=function(t){this._methodName=t},Zh=function(t){this.d_=t};function $h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new li(t)}function tf(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new na,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function ef(t){this.observer=t,this.muted=!1}function nf(t,e,n){if(!n)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function rf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(Gr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function of(t,e,n,r){if(!0===e&&!0===r)throw new Br(Gr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function sf(t){if(!pi.wt(t))throw new Br(Gr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function uf(t){if(pi.wt(t))throw new Br(Gr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function af(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function cf(t,e){if("_delegate"in t&&(t=t.d_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Br(Gr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=af(t);throw new Br(Gr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function hf(t,e){if(e<=0)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ff,lf=(Ef.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ef),pf=new Map,df=(Object.defineProperty(_f.prototype,"app",{get:function(){if(!this.A_)throw new Br(Gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),_f.prototype.g_=function(t){if(this.T_)throw new Br(Gr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new lf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Kr;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new $r(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Br(Gr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},_f.prototype.V_=function(){return this.E_},_f.prototype.p_=function(){return this.T_=!0,this.E_},_f.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},_f.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},_f.prototype.b_=function(){return(t=pf.get(this))&&(Dr("ComponentProvider","Removing Datastore"),pf.delete(this),t.terminate()),Promise.resolve();var t},_f),yf=(Object.defineProperty(bf.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"parent",{get:function(){return new gf(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),bf.prototype.withConverter=function(t){return new bf(this.firestore,t,this.S_)},bf),vf=(wf.prototype.withConverter=function(t){return new wf(this.firestore,t,this.C_)},wf),gf=(f(mf,ff=vf),Object.defineProperty(mf.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new yf(this.firestore,null,new pi(t))},enumerable:!1,configurable:!0}),mf.prototype.withConverter=function(t){return new mf(this.firestore,t,this.D_)},mf);function mf(t,e,n){var r=this;return(r=ff.call(this,t,e,qo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function wf(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function bf(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function _f(t,e){this.w_="(lite)",this.E_=new lf({}),this.T_=!1,t instanceof Ar?(this.I_=t,this.m_=new Kr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Br(Gr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ar(t.options.projectId)}(t),this.m_=new Jr(e))}function Ef(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(Gr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Br(Gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,of("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Tf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Zh&&(t=t.d_),nf("collection","path",e),t instanceof df)return uf(n=hi.ot.apply(hi,l([e],r))),new gf(t,null,n);if(!(t instanceof yf||t instanceof gf))throw new Br(Gr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return uf(n=hi.ot.apply(hi,l([t.path],r)).child(hi.ot(e))),new gf(t.firestore,null,n)}function If(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Zh&&(t=t.d_),1===arguments.length&&(e=Vr.u()),nf("doc","path",e),t instanceof df)return sf(n=hi.ot.apply(hi,l([e],r))),new yf(t,null,new pi(n));if(!(t instanceof yf||t instanceof gf))throw new Br(Gr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return sf(n=t.D_.child(hi.ot.apply(hi,l([e],r)))),new yf(t.firestore,t instanceof gf?t.v_:null,new pi(n))}function Af(t,e){return t instanceof Zh&&(t=t.d_),e instanceof Zh&&(e=e.d_),(t instanceof yf||t instanceof gf)&&(e instanceof yf||e instanceof gf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Nf(t,e){return t instanceof Zh&&(t=t.d_),e instanceof Zh&&(e=e.d_),t instanceof vf&&e instanceof vf&&t.firestore===e.firestore&&Ko(t.C_,e.C_)&&t.v_===e.v_}var Sf=(Object.defineProperty(Pf.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Pf.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Pf.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Pf.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Pf.prototype.U=function(t){return Ur(this.x_,t.x_)||Ur(this.N_,t.N_)},Pf),Of=/^__.*__$/,Df=(Rf.prototype.F_=function(t,e){return null!==this.Gt?new ks(t,this.data,this.Gt,e,this.fieldTransforms):new Ps(t,this.data,e,this.fieldTransforms)},Rf),Lf=(Cf.prototype.F_=function(t,e){return new ks(t,this.data,this.Gt,e,this.fieldTransforms)},Cf);function Cf(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Rf(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Pf(t,e){if(!isFinite(t)||t<-90||90<t)throw new Br(Gr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Br(Gr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function kf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Vf=(Object.defineProperty(Mf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Mf.prototype.M_=function(t){return new Mf(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},Mf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},Mf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},Mf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Mf.prototype.K_=function(t){return pl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Mf.prototype.contains=function(e){return void 0!==this.Gt.find(function(t){return e.nt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.nt(t.field)})},Mf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Mf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(kf(this.k_)&&Of.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Mf),xf=(Uf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Vf({k_:t,methodName:e,j_:n,path:li.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},Uf);function Uf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Sc(t)}function Mf(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}function jf(t){var e=t.p_(),n=Sc(t.I_);return new xf(t.I_,!!e.ignoreUndefinedProperties,n)}function Ff(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);cl("Data must be an object, but it was:",s,r);var u,a,r=ul(r,s);if(o.merge)u=new Ti(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=hl(e,f[h],n);if(!s.contains(l))throw new Br(Gr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");dl(c,l)||c.push(l)}u=new Ti(c),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new Df(new Hi(r),u,a)}var qf,Gf=(f(Bf,qf=Jh),Bf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},Bf.prototype.isEqual=function(t){return t instanceof Bf},Bf);function Bf(){return null!==qf&&qf.apply(this,arguments)||this}function zf(t,e,n){return new Vf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Hf,Yf,Qf,Xf,Wf=(f(nl,Xf=Jh),nl.prototype.z_=function(t){return new Ts(t.path,new cs)},nl.prototype.isEqual=function(t){return t instanceof nl},nl),Kf=(f(el,Qf=Jh),el.prototype.z_=function(t){var e=zf(this,t,!0),n=this.H_.map(function(t){return sl(t,e)}),n=new hs(n);return new Ts(t.path,n)},el.prototype.isEqual=function(t){return this===t},el),Jf=(f(tl,Yf=Jh),tl.prototype.z_=function(t){var e=zf(this,t,!0),n=this.H_.map(function(t){return sl(t,e)}),n=new ys(n);return new Ts(t.path,n)},tl.prototype.isEqual=function(t){return this===t},tl),Zf=(f($f,Hf=Jh),$f.prototype.z_=function(t){var e=new ws(t.Qt,os(t.Qt,this.J_));return new Ts(t.path,e)},$f.prototype.isEqual=function(t){return this===t},$f);function $f(t,e){var n=this;return(n=Hf.call(this,t)||this).J_=e,n}function tl(t,e){var n=this;return(n=Yf.call(this,t)||this).H_=e,n}function el(t,e){var n=this;return(n=Qf.call(this,t)||this).H_=e,n}function nl(){return null!==Xf&&Xf.apply(this,arguments)||this}function rl(t,r,i,e){var o=t.G_(1,r,i);cl("Data must be an object, but it was:",o,e);var s=[],u=new Yi;_i(e,function(t,e){var n=ll(r,t,i);e instanceof Zh&&(e=e.d_);t=o.U_(n);e instanceof Gf?s.push(n):null!=(t=sl(e,t))&&(s.push(n),u.set(n,t))});e=new Ti(s);return new Lf(u.Pt(),e,o.fieldTransforms)}function il(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[hl(e,r,n)],a=[i];if(o.length%2!=0)throw new Br(Gr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(hl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Yi,y=u.length-1;0<=y;--y){dl(p,u[y])||(h=u[y],(f=a[y])instanceof Zh&&(f=f.d_),l=s.U_(h),f instanceof Gf?p.push(h):null!=(l=sl(f,l))&&(p.push(h),d.set(h,l)))}i=new Ti(p);return new Lf(d.Pt(),i,s.fieldTransforms)}function ol(t,e,n,r){return void 0===r&&(r=!1),sl(n,t.G_(r?4:3,e))}function sl(s,t){if(s instanceof Zh&&(s=s.d_),al(s))return cl("Unsupported field value:",t,s),ul(s,t);if(s instanceof Jh)return function(t,e){if(!kf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.Gt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=sl(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Zh&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return os(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ai.fromDate(t);return{timestampValue:xu(e.Qt,n)}}if(t instanceof ai)return n=new ai(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:xu(e.Qt,n)};if(t instanceof Sf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zr)return{bytesValue:Uu(e.Qt,t.I)};if(t instanceof yf){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ju(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+af(t))}(s,t)}function ul(t,n){var r={};return Ei(t)?n.path&&0<n.path.length&&n.Gt.push(n.path):_i(t,function(t,e){e=sl(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function al(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ai||t instanceof Sf||t instanceof zr||t instanceof yf||t instanceof Jh)}function cl(t,e,n){if(!al(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=af(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function hl(t,e,n){if(e instanceof Zh&&(e=e.d_),e instanceof Kh)return e.f_;if("string"==typeof e)return ll(t,e);throw pl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var fl=new RegExp("[~\\*/\\[\\]]");function ll(e,n,r){if(0<=n.search(fl))throw pl("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Kh.bind.apply(Kh,l([void 0],n.split("."))))).f_}catch(t){throw pl("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function pl(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Br(Gr.INVALID_ARGUMENT,(e+=". ")+t+n)}function dl(t,e){return t.some(function(t){return t.isEqual(e)})}var yl=(bl.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Br(Gr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=zu((n=s).Qt)+"/documents",r={documents:u.map(function(t){return qu(n.Qt,t)})},[4,n.Du("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Qt,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=Gu(t,e.found.name),t=Mu(e.found.updateTime),e=new Hi({mapValue:{fields:e.found.fields}});return new Zi(n,t,e,{})}(e,t):"missing"in t?function(t,e){kr(!!e.missing),kr(!!e.readTime);t=Gu(t,e.missing),e=Mu(e.readTime);return new $i(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());kr(!!t),o.push(t)}),o)]}})})}(this.Sh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $i||t instanceof Zi?n.sf(t):Pr()}),e)]}})})},bl.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},bl.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},bl.prototype.delete=function(t){this.write(new Hs(t,this.jt(t))),this.tf.add(t.toString())},bl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=pi._t(e);n.mutations.push(new Ys(e,n.jt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=zu((e=i).Qt)+"/documents",r={writes:o.map(function(t){return Qu(e.Qt,t)})},[4,e.pu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},bl.prototype.sf=function(t){var e;if(t instanceof Zi)e=t.version;else{if(!(t instanceof $i))throw Pr();e=ci.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(Gr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},bl.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?As.updateTime(e):As.Kt()},bl.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return As.exists(!0);if(e.isEqual(ci.min()))throw new Br(Gr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},bl.prototype.write=function(t){this.nf(),this.mutations.push(t)},bl.prototype.nf=function(){},bl),vl=(wl.prototype.run=function(){this.af()},wl.prototype.af=function(){var t=this;this.Gu.$u(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new yl(this.Sh),(n=this.uf(e))&&n.then(function(t){r._s.Ps(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},wl.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Ci(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},wl.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},wl.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ws(t)},wl),gl=(ml.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},ml.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},ml.prototype.df=function(){if(this._s.wf)throw new Br(Gr.FAILED_PRECONDITION,"The client has already been terminated.")},ml.prototype.terminate=function(){var t=this;this._s.Ef();var n=new na;return this._s.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.S(),n.resolve(),[3,6];case 5:return e=t.sent(),e=aa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},ml);function ml(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Hr.UNAUTHENTICATED,this.clientId=Vr.u(),this._f=function(){},this.C=new na,this.credentials.v(function(t){Dr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}function wl(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Rc(this._s,"transaction_retry")}function bl(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function _l(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Dr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i._s.Af(),Dr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Jl,i.ff(function(e){n.isEqual(e)||(n=e,i._s.po(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Va(o.bh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.Po(function(){return i.terminate()}),i.mf=o,[2]}})})}(e,new Bh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function El(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Dr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r._s.Af(),[4,_l(r)];case 1:return e=t.sent(),Dr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r._s.po(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r)._s.Af(),Dr("RemoteStore","RemoteStore received new credentials"),n=Jc(e),e.Nh.add(3),[4,zc(e)];case 1:return t.sent(),n&&e.kh.set("Unknown"),[4,e.Dh.n_(i)];case 2:return t.sent(),e.Nh.delete(3),[4,Bc(e)];case 3:return t.sent(),[2]}})})}(i.yl,t)})}),r.If=i,[2]}})})}(e,new zh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Tl(t){return _l(t).then(function(t){return t.persistence})}function Il(t){return _l(t).then(function(t){return t.bh})}function Al(t){return El(t).then(function(t){return t.yl})}function Nl(t){return El(t).then(function(t){return t._a})}function Sl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,El(r)];case 1:return e=t.sent(),[2,((n=e.gl).jh=Dh.bind(null,e._a),n.Hh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vl.get(o),1<(r=e.Sl.get(n.targetId)).length?[2,(e.Sl.set(n.targetId,r.filter(function(t){return!Ko(t,o)})),void e.vl.delete(o))]:e.Ll?(e.Vl.Ma(n.targetId),e.Vl.Da(n.targetId)?[3,2]:[4,qa(e.bh,n.targetId,!1).then(function(){e.Vl.$a(n.targetId),Yc(e.yl,n.targetId),xh(e,n.targetId)}).catch(ba)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return xh(e,n.targetId),[4,qa(e.bh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e._a),n)]}})})}function Ol(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Xh({next:function(t){r.Ps(function(){return hh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Br(Gr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Br(Gr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new lh(qo(i.path),t,{includeMetadataChanges:!0,nl:!0});return ch(n,u)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}function Dl(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Xh({next:function(t){n.Ps(function(){return hh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Br(Gr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new lh(t,o,{includeMetadataChanges:!0,nl:!0});return ch(e,s)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}var Ll=(Object.defineProperty(Cl.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),Cl.prototype.Ps=function(t){this.enqueue(t)},Cl.prototype.Tf=function(t){this.Sf(),this.Df(t)},Cl.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Nc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},Cl.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},Cl.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},Cl.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.Gu.$u(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},Cl.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},Cl.prototype.Tr=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=sa.Ts(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},Cl.prototype.Sf=function(){this.Vf&&Pr()},Cl.prototype.Af=function(){},Cl.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},Cl.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},Cl.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ds-e.ds});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Rs(),"all"!==r&&n.fs===r)break}return i.Nf()})},Cl.prototype.kf=function(t){this.bf.push(t)},Cl.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},Cl);function Cl(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Rc(this,"async_queue_retry"),this.vf=function(){var t=Nc();t&&Dr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Gu.qu()};var t=Nc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function Rl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Pl,kl=(Ul.prototype.onProgress=function(t,e,n){this.Mf={next:t,error:e,complete:n}},Ul.prototype.catch=function(t){return this.Lf.promise.catch(t)},Ul.prototype.then=function(t,e){return this.Lf.promise.then(t,e)},Ul.prototype.ql=function(t){this.Ul(t),this.Mf.complete&&this.Mf.complete(),this.Lf.resolve(t)},Ul.prototype.Kl=function(t){this.$f.taskState="Error",this.Mf.next&&this.Mf.next(this.$f),this.Mf.error&&this.Mf.error(t),this.Lf.reject(t)},Ul.prototype.Ul=function(t){this.$f=t,this.Mf.next&&this.Mf.next(t)},Ul),Vl=(f(xl,Pl=df),xl.prototype.b_=function(){return this.qf||jl(this),this.qf.terminate()},xl);function xl(t,e){var n=this;return(n=Pl.call(this,t,e)||this).Bf=new Ll,n.w_="name"in t?t.name:"[DEFAULT]",n}function Ul(){this.Mf={},this.Lf=new na,this.$f={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Ml(t){return t.qf||jl(t),t.qf.df(),t.qf}function jl(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Ir(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.qf=new gl(t.m_,t.Bf,r)}var Fl,o=(Hl.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Pi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Si(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Oi(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Pr()}},Hl.prototype.Hf=function(t,n){var r=this,i={};return _i(t.fields||{},function(t,e){i[t]=r.Uf(e,n)}),i},Hl.prototype.Gf=function(t){return new Sf(Si(t.latitude),Si(t.longitude))},Hl.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},Hl.prototype.Kf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Di(e)?t(e):e}(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Li(t));default:return null}},Hl.prototype.Qf=function(t){t=Ni(t);return new ai(t.seconds,t.nanos)},Hl.prototype.Jf=function(t,e){var n=hi.ot(t);kr(ea(n));t=new Ar(n.get(1),n.get(3)),n=new pi(n.Y(5));return t.isEqual(e)||Lr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Hl),ql=(Object.defineProperty(zl.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"ref",{get:function(){return new yf(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),zl.prototype.exists=function(){return null!==this.Zf},zl.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Gl(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},zl.prototype.get=function(t){if(this.Zf){t=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t)}},zl),Gl=(f(Bl,Fl=ql),Bl.prototype.data=function(){return Fl.prototype.data.call(this)},Bl);function Bl(){return null!==Fl&&Fl.apply(this,arguments)||this}function zl(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}function Hl(){}function Yl(t,e){return"string"==typeof e?ll(t,e):(e instanceof Zh?e.d_:e).f_}function Ql(t){if(Bo(t)&&0===t.xt.length)throw new Br(Gr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Te=function(){};function Xl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].td(t)}return t}var Wl,Kl,Jl,Zl,$l,tp=(f(cp,$l=Te),cp.prototype.td=function(t){var e=jf(t.firestore),e=function(t,e,n,r,i,o){if(r.ut()){if("array-contains"===i||"array-contains-any"===i)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){lp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(fp(n,t,c))}h={arrayValue:{values:s}}}else h=fp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||lp(o,i),h=ol(e,"where",o,"in"===i||"not-in"===i);var h=ho.create(r,i,h);return function(t,e){if(e.Ct()){var n=Ho(t);if(null!==n&&!n.isEqual(e.field))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=zo(t);null!==n&&pp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Br(Gr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Br(Gr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.ed,this.nd,this.sd);return new vf(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new Fo(t.path,t.collectionGroup,t.xt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},cp),ep=(f(ap,Zl=Te),ap.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Uo(e,n);return e=r,null!==zo(n=t)||null!==(t=Ho(n))&&pp(0,t,e.field),r}(t.C_,this.ed,this.rd);return new vf(t.firestore,t.v_,(t=t.C_,e=t.xt.concat([e]),new Fo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},ap),np=(f(up,Jl=Te),up.prototype.td=function(t){return new vf(t.firestore,t.v_,Wo(t.C_,this.od,this.ad))},up),rp=(f(sp,Kl=Te),sp.prototype.td=function(t){var e=hp(t,this.type,this.ud,this.hd);return new vf(t.firestore,t.v_,(t=t.C_,e=e,new Fo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},sp),ip=(f(op,Wl=Te),op.prototype.td=function(t){var e=hp(t,this.type,this.ud,this.hd);return new vf(t.firestore,t.v_,(t=t.C_,e=e,new Fo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},op);function op(t,e,n){var r=this;return(r=Wl.call(this)||this).type=t,r.ud=e,r.hd=n,r}function sp(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.ud=e,r.hd=n,r}function up(t,e,n){var r=this;return(r=Jl.call(this)||this).type=t,r.od=e,r.ad=n,r}function ap(t,e){var n=this;return(n=Zl.call(this)||this).ed=t,n.rd=e,n.type="orderBy",n}function cp(t,e,n){var r=this;return(r=$l.call(this)||this).ed=t,r.nd=e,r.sd=n,r.type="where",r}function hp(t,c,e,n){if(e[0]instanceof Zh&&(e[0]=e[0].d_),e[0]instanceof ql)return function(t,e,n,r){if(!n)throw new Br(Gr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Qo(t);o<s.length;o++){var u=s[o];if(u.field.ut())i.push(ji(e,n.key));else{var a=n.field(u.field);if(Di(a))throw new Br(Gr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.rt();throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Co(i,r)}(t.C_,t.firestore.I_,e[0].Zf,n);var r=jf(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Br(Gr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Yo(t)&&-1!==c.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(hi.ot(c));if(!pi.wt(h))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new pi(h);u.push(ji(e,h))}else{c=ol(n,r,c);u.push(c)}}return new Co(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function fp(t,e,n){if(n instanceof Zh&&(n=n.d_),"string"==typeof n){if(""===n)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yo(e)&&-1!==n.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(hi.ot(n));if(!pi.wt(e))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ji(t,new pi(e))}if(n instanceof yf)return ji(t,n.S_);throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+af(n)+".")}function lp(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pp(t,e,n){if(!n.isEqual(e))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function dp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var yp,vp,gp,mp=(f(Sp,gp=o),Sp.prototype.Wf=function(t){return new zr(t)},Sp.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new yf(this.firestore,null,t)},Sp),wp=(Np.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Np),bp=(f(Ap,vp=ql),Ap.prototype.exists=function(){return vp.prototype.exists.call(this)},Ap.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new _p(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},Ap.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){t=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t,e.serverTimestamps)}},Ap),_p=(f(Ip,yp=bp),Ip.prototype.data=function(t){return void 0===t&&(t={}),yp.prototype.data.call(this,t)},Ip),Ep=(Object.defineProperty(Tp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Tp.prototype.forEach=function(e,n){var r=this;this._d.docs.forEach(function(t){e.call(n,new _p(r.Yf,r.Xf,t.key,t,new wp(r._d.De.has(t.key),r._d.fromCache),r.query.v_))})},Tp.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this._d.xe)throw new Br(Gr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===t||(this.fd=function(i,e){if(i._d.Se.et()){var n=0;return i._d.docChanges.map(function(t){var e=new _p(i.Yf,i.Xf,t.doc.key,t.doc,new wp(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._d.Se;return i._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new _p(i.Yf,i.Xf,t.doc.key,t.doc,new wp(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.dd=t),this.fd},Tp);function Tp(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new wp(r.hasPendingWrites,r.fromCache),this.query=n}function Ip(){return null!==yp&&yp.apply(this,arguments)||this}function Ap(t,e,n,r,i,o){var s=this;return(s=vp.call(this,t,e,n,r,o)||this).Yf=t,s.ld=t,s.metadata=i,s}function Np(t,e){this.hasPendingWrites=t,this.fromCache=e}function Sp(t){var e=this;return(e=gp.call(this)||this).firestore=t,e}function Op(t,e){return t instanceof bp&&e instanceof bp?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Ep&&e instanceof Ep&&t.Yf===e.Yf&&Nf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var Dp,Lp=(f(Cp,Dp=o),Cp.prototype.Wf=function(t){return new zr(t)},Cp.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new yf(this.firestore,null,t)},Cp);function Cp(t){var e=this;return(e=Dp.call(this)||this).firestore=t,e}function Rp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=cf(t,yf);var o=cf(t.firestore,Vl),s=jf(o);return e instanceof Zh&&(e=e.d_),kp(o,[("string"==typeof e||e instanceof Kh?il(s,"updateDoc",t.S_,e,n,r):rl(s,"updateDoc",t.S_,e)).F_(t.S_,As.exists(!0))])}function Pp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Zh&&(e=e.d_);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Rl(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Rl(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof yf?(u=cf(e.firestore,Vl),a=qo(e.S_.path),h={next:function(t){n[i]&&n[i](Vp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=cf(e,vf),u=cf(s.firestore,Vl),a=s.C_,c=new Lp(u),h={next:function(t){n[i]&&n[i](new Ep(u,c,s,t))},error:n[i+1],complete:n[i+2]},Ql(e.C_)),function(n,t,e){var r=this,i=new Xh(h),o=new lh(t,i,e);return n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ch,[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.i_(),n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hh,[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ml(u),a,f)}function kp(t,e){return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,Nl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ml(t),e)}function Vp(t,e,n){var r=n.docs.get(e.S_),i=new Lp(t);return new bp(t,i,e.S_,r,new wp(n.hasPendingWrites,n.fromCache),e.v_)}var xp=(Up.prototype.set=function(t,e,n){this.md();t=Mp(t,this.Yf),e=dp(t.v_,e,n),n=Ff(this.Id,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.Ed.push(n.F_(t.S_,As.Kt())),this},Up.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();t=Mp(t,this.Yf);return e instanceof Zh&&(e=e.d_),e="string"==typeof e||e instanceof Kh?il(this.Id,"WriteBatch.update",t.S_,e,n,r):rl(this.Id,"WriteBatch.update",t.S_,e),this.Ed.push(e.F_(t.S_,As.exists(!0))),this},Up.prototype.delete=function(t){this.md();t=Mp(t,this.Yf);return this.Ed=this.Ed.concat(new Hs(t.S_,As.Kt())),this},Up.prototype.commit=function(){return this.md(),this.Td=!0,0<this.Ed.length?this.wd(this.Ed):Promise.resolve()},Up.prototype.md=function(){if(this.Td)throw new Br(Gr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Up);function Up(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=jf(t)}function Mp(t,e){if(t instanceof Zh&&(t=t.d_),t.firestore!==e)throw new Br(Gr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var jp,Fp=(Gp.prototype.get=function(t){var e=this,n=Mp(t,this.Yf),r=new mp(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof $i)return new ql(e.Yf,r,n.S_,null,n.v_);if(t instanceof Zi)return new ql(e.Yf,r,t.key,t,n.v_);throw Pr()})},Gp.prototype.set=function(t,e,n){t=Mp(t,this.Yf),e=dp(t.v_,e,n),n=Ff(this.Id,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Ad.set(t.S_,n),this},Gp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Mp(t,this.Yf);return e instanceof Zh&&(e=e.d_),e="string"==typeof e||e instanceof Kh?il(this.Id,"Transaction.update",t.S_,e,n,r):rl(this.Id,"Transaction.update",t.S_,e),this.Ad.update(t.S_,e),this},Gp.prototype.delete=function(t){t=Mp(t,this.Yf);return this.Ad.delete(t.S_),this},f(qp,jp=Gp),qp.prototype.get=function(t){var e=this,n=Mp(t,this.Yf),r=new Lp(this.Yf);return jp.prototype.get.call(this,t).then(function(t){return new bp(e.Yf,r,n.S_,t.Zf,new wp(!1,!1),n.v_)})},qp);function qp(t,e){var n=this;return(n=jp.call(this,t,e)||this).Yf=t,n}function Gp(t,e){this.Yf=t,this.Ad=e,this.Id=jf(t)}function Bp(){if("undefined"==typeof Uint8Array)throw new Br(Gr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function zp(){if("undefined"==typeof atob)throw new Br(Gr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hp,Yp,Qp,Xp=(f(nd,Qp=Zh),nd.fromBase64String=function(t){return zp(),new nd(zr.fromBase64String(t))},nd.fromUint8Array=function(t){return Bp(),new nd(zr.fromUint8Array(t))},nd.prototype.toBase64=function(){return zp(),this.d_.toBase64()},nd.prototype.toUint8Array=function(){return Bp(),this.d_.toUint8Array()},nd.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},nd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},nd),Wp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Kp=(ed.prototype.enableIndexedDbPersistence=function(t,e){throw new Br(Gr.FAILED_PRECONDITION,Wp)},ed.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Br(Gr.FAILED_PRECONDITION,Wp)},ed.prototype.clearIndexedDbPersistence=function(t){throw new Br(Gr.FAILED_PRECONDITION,Wp)},ed),Jp=(f(td,Yp=Zh),Object.defineProperty(td.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),td.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},td.prototype.useEmulator=function(t,e){var n,r;n=this.d_,r=t,t=e,"firestore.googleapis.com"!==(e=(n=cf(n,df)).V_()).host&&e.host!==r&&Cr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},td.prototype.enableNetwork=function(){return function(r){var t=this;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Tl(r)];case 1:return e=t.sent(),[4,Al(r)];case 2:return n=t.sent(),[2,(e.yo(!0),(t=n).Nh.delete(0),Bc(t))]}})})})}(Ml(cf(this.d_,Vl)))},td.prototype.disableNetwork=function(){return function(r){var t=this;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Tl(r)];case 1:return e=t.sent(),[4,Al(r)];case 2:return n=t.sent(),[2,(e.yo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(0),[4,zc(e)];case 1:return t.sent(),e.kh.set("Offline"),[2]}})})}(n))]}})})})}(Ml(cf(this.d_,Vl)))},td.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&of("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},td.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},td.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},td.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ph,[4,Nl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ml(cf(this.d_,Vl)))},td.prototype.onSnapshotsInSync=function(t){return e=this.d_,t=t,function(n,t){var e=this,r=new Xh(t);return n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.i_(),n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ml(cf(e,Vl)),Rl(t)?t:{next:t});var e},Object.defineProperty(td.prototype,"app",{get:function(){if(!this.Pd)throw new Br(Gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),td.prototype.collection=function(t){try{return new Dd(this,Tf(this.d_,t))}catch(t){throw yd(t,"collection()","Firestore.collection()")}},td.prototype.doc=function(t){try{return new pd(this,If(this.d_,t))}catch(t){throw yd(t,"doc()","Firestore.doc()")}},td.prototype.collectionGroup=function(t){try{return new Nd(this,function(t,e){if(t=cf(t,df),nf("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new vf(t,null,(e=e,new Fo(hi.ct(),e)))}(this.d_,t))}catch(t){throw yd(t,"collectionGroup()","Firestore.collectionGroup()")}},td.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,El(n).then(function(t){return t.Sh})];case 1:return e=t.sent(),new vl(n._s,e,r,i).run(),[2]}})})}),i.promise}(Ml(n=this.d_),function(t){return t=new Fp(n,t),e(new sd(r,t))})},td.prototype.batch=function(){var e=this;return Ml(this.d_),new ud(new xp(this.d_,function(t){return kp(e.d_,t)}))},td.prototype.loadBundle=function(t){throw new Br(Gr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},td.prototype.namedQuery=function(t){throw new Br(Gr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},td),Zp=(f($p,Hp=o),$p.prototype.Wf=function(t){return new Xp(new zr(t))},$p.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return pd.yd(t,this.firestore,null)},$p);function $p(t){var e=this;return(e=Hp.call(this)||this).firestore=t,e}function td(t,e,n){var r=this;return(r=Yp.call(this,e)||this).Rd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ar||(r.Pd=t),r}function ed(){}function nd(){return null!==Qp&&Qp.apply(this,arguments)||this}var rd,id,od,sd=(f(fd,od=Zh),fd.prototype.get=function(t){var e=this,n=xd(t);return this.d_.get(n).then(function(t){return new Id(e.Yf,new bp(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},fd.prototype.set=function(t,e,n){t=xd(t);return n?(rf("Transaction.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},fd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=xd(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,l([o,e,n],r)),this},fd.prototype.delete=function(t){t=xd(t);return this.d_.delete(t),this},fd),ud=(f(hd,id=Zh),hd.prototype.set=function(t,e,n){t=xd(t);return n?(rf("WriteBatch.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},hd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=xd(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,l([o,e,n],r)),this},hd.prototype.delete=function(t){t=xd(t);return this.d_.delete(t),this},hd.prototype.commit=function(){return this.d_.commit()},hd),ad=(f(cd,rd=Zh),cd.prototype.fromFirestore=function(t,e){t=new _p(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new Ad(this.Yf,t),null!=e?e:{})},cd.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},cd.gd=function(t,e){var n=cd.Vd,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new cd(t,new Zp(t),e),r.set(e,n)),n},cd);function cd(t,e,n){var r=this;return(r=rd.call(this,n)||this).Yf=t,r.Xf=e,r}function hd(){return null!==id&&id.apply(this,arguments)||this}function fd(t,e){var n=this;return(n=od.call(this,e)||this).Yf=t,n.Xf=new Zp(t),n}ad.Vd=new WeakMap;var ld,pd=(f(dd,ld=Zh),dd.pd=function(t,e,n){if(t.length%2!=0)throw new Br(Gr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new dd(e,new yf(e.d_,n,new pi(t)))},dd.yd=function(t,e,n){return new dd(e,new yf(e.d_,n,t))},Object.defineProperty(dd.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"parent",{get:function(){return new Dd(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),dd.prototype.collection=function(t){try{return new Dd(this.firestore,Tf(this.d_,t))}catch(t){throw yd(t,"collection()","DocumentReference.collection()")}},dd.prototype.isEqual=function(t){return t instanceof Zh&&(t=t.d_),t instanceof yf&&Af(this.d_,t)},dd.prototype.set=function(t,e){e=rf("DocumentReference.set",e);try{return function(t,e,n){t=cf(t,yf);var r=cf(t.firestore,Vl),e=dp(t.v_,e,n);return kp(r,[Ff(jf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,As.Kt())])}(this.d_,t,e)}catch(t){throw yd(t,"setDoc()","DocumentReference.set()")}},dd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Rp(this.d_,t):Rp.apply(void 0,l([this.d_,t,e],n))}catch(t){throw yd(t,"updateDoc()","DocumentReference.update()")}},dd.prototype.delete=function(){return kp(cf((t=this.d_).firestore,Vl),[new Hs(t.S_,As.Kt())]);var t},dd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=vd(t),i=gd(t,function(t){return new Id(e.firestore,new bp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))});return Pp(this.d_,r,i)},dd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=cf(e,yf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Lp(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Tc.Ho(t,e)}))];case 1:return(i=t.sent())instanceof Zi?u.resolve(i):i instanceof $i?u.resolve(null):u.reject(new Br(Gr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=aa(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new bp(n,r,e.S_,t,new wp(t instanceof Zi&&t.Vt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=cf(e,yf);var n=cf(e.firestore,Vl);return Ol(Ml(n),e.S_,{source:"server"}).then(function(t){return Vp(n,e,t)})}:function(e){e=cf(e,yf);var n=cf(e.firestore,Vl);return Ol(Ml(n),e.S_).then(function(t){return Vp(n,e,t)})})(this.d_).then(function(t){return new Id(e.firestore,new bp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},dd.prototype.withConverter=function(t){return new dd(this.firestore,this.d_.withConverter(ad.gd(this.firestore,t)))},dd);function dd(t,e){var n=this;return(n=ld.call(this,e)||this).firestore=t,n.Xf=new Zp(t),n}function yd(t,e,n){return t.message=t.message.replace(e,n),t}function vd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Rl(r))return r}return{}}function gd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Rl(t[0])?t[0]:Rl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var md,wd,bd,_d,Ed,Td,Id=(f(Vd,Td=Zh),Object.defineProperty(Vd.prototype,"ref",{get:function(){return new pd(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),Vd.prototype.data=function(t){return this.d_.data(t)},Vd.prototype.get=function(t,e){return this.d_.get(t,e)},Vd.prototype.isEqual=function(t){return Op(this.d_,t.d_)},Vd),Ad=(f(kd,Ed=Id),kd.prototype.data=function(t){return this.d_.data(t)},kd),Nd=(f(Pd,_d=Zh),Pd.prototype.where=function(t,e,n){try{return new Pd(this.firestore,Xl(this.d_,(r=n,i=e,o=Yl("where",t),new tp(o,i,r))))}catch(t){throw yd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Pd.prototype.orderBy=function(n,t){try{return new Pd(this.firestore,Xl(this.d_,function(t){void 0===t&&(t="asc");var e=t,t=Yl("orderBy",n);return new ep(t,e)}(t)))}catch(n){throw yd(n,/(orderBy|where)\(\)/,"Query.$1()")}},Pd.prototype.limit=function(t){try{return new Pd(this.firestore,Xl(this.d_,(hf("limit",e=t),new np("limit",e,"F"))))}catch(t){throw yd(t,"limit()","Query.limit()")}var e},Pd.prototype.limitToLast=function(t){try{return new Pd(this.firestore,Xl(this.d_,(hf("limitToLast",e=t),new np("limitToLast",e,"L"))))}catch(t){throw yd(t,"limitToLast()","Query.limitToLast()")}var e},Pd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Pd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw yd(t,"startAt()","Query.startAt()")}},Pd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Pd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw yd(t,"startAfter()","Query.startAfter()")}},Pd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Pd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw yd(t,"endBefore()","Query.endBefore()")}},Pd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Pd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw yd(t,"endAt()","Query.endAt()")}},Pd.prototype.isEqual=function(t){return Nf(this.d_,t.d_)},Pd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Lp(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ga(i,o,!0)];case 1:return r=t.sent(),e=new Th(o,r.Rc),n=e.fl(r.documents),n=e.wi(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=aa(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Ep(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Lp(n);return Dl(t,e.C_,{source:"server"}).then(function(t){return new Ep(n,r,e,t)})}:function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Lp(n);return Ql(e.C_),Dl(t,e.C_).then(function(t){return new Ep(n,r,e,t)})})(this.d_).then(function(t){return new Od(e.firestore,new Ep(e.firestore.d_,e.Xf,e.d_,t._d))})},Pd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=vd(t),i=gd(t,function(t){return new Od(e.firestore,new Ep(e.firestore.d_,e.Xf,e.d_,t._d))});return Pp(this.d_,r,i)},Pd.prototype.withConverter=function(t){return new Pd(this.firestore,this.d_.withConverter(ad.gd(this.firestore,t)))},Pd),Sd=(f(Rd,bd=Zh),Object.defineProperty(Rd.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"doc",{get:function(){return new Ad(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),Rd),Od=(f(Cd,wd=Zh),Object.defineProperty(Cd.prototype,"query",{get:function(){return new Nd(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"docs",{get:function(){var e=this;return this.d_.docs.map(function(t){return new Ad(e.Yf,t)})},enumerable:!1,configurable:!0}),Cd.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new Sd(e.Yf,t)})},Cd.prototype.forEach=function(e,n){var r=this;this.d_.forEach(function(t){e.call(n,new Ad(r.Yf,t))})},Cd.prototype.isEqual=function(t){return Op(this.d_,t.d_)},Cd),Dd=(f(Ld,md=Nd),Object.defineProperty(Ld.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new pd(this.firestore,t):null},enumerable:!1,configurable:!0}),Ld.prototype.doc=function(t){try{return new pd(this.firestore,void 0===t?If(this.d_):If(this.d_,t))}catch(t){throw yd(t,"doc()","CollectionReference.doc()")}},Ld.prototype.add=function(t){var e,n,r,i=this;return e=this.d_,n=t,t=cf(e.firestore,Vl),r=If(e),n=dp(e.v_,n),kp(t,[Ff(jf(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,As.exists(!1))]).then(function(){return r}).then(function(t){return new pd(i.firestore,t)})},Ld.prototype.isEqual=function(t){return Af(this.d_,t.d_)},Ld.prototype.withConverter=function(t){return new Ld(this.firestore,this.d_.withConverter(ad.gd(this.firestore,t)))},Ld);function Ld(t,e){var n=this;return(n=md.call(this,t,e)||this).firestore=t,n.d_=e,n}function Cd(t,e){var n=this;return(n=wd.call(this,e)||this).Yf=t,n}function Rd(t,e){var n=this;return(n=bd.call(this,e)||this).Yf=t,n}function Pd(t,e){var n=this;return(n=_d.call(this,e)||this).firestore=t,n.Xf=new Zp(t),n}function kd(){return null!==Ed&&Ed.apply(this,arguments)||this}function Vd(t,e){var n=this;return(n=Td.call(this,e)||this).Yf=t,n}function xd(t){return t instanceof Zh&&(t=t.d_),cf(t,yf)}var Ud,Md,Te=(f(Fd,Md=Zh),Fd.documentId=function(){return new Fd(li.ht().rt())},Fd.prototype.isEqual=function(t){return t instanceof Zh&&(t=t.d_),t instanceof Kh&&this.d_.f_.isEqual(t.f_)},Fd),o=(f(jd,Ud=Zh),jd.serverTimestamp=function(){var t=new Wf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new jd(t)},jd.delete=function(){var t=new Gf("deleteField");return t._methodName="FieldValue.delete",new jd(t)},jd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new jd(n)},jd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new jd(n)},jd.increment=function(t){t=new Zf("increment",t);return t._methodName="FieldValue.increment",new jd(t)},jd.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},jd);function jd(){return null!==Ud&&Ud.apply(this,arguments)||this}function Fd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Md.call(this,new(Kh.bind.apply(Kh,l([void 0],t))))||this}function qd(t){return e=this.d_,s=t,n=Ml(e=cf(e,Vl)),t=new kl,function(n,t,r){var e,i=this,o=(e=s,t=Sc(t),e=function(t){if(t instanceof Uint8Array)return Qh(t,void 0);if(t instanceof ArrayBuffer)return Qh(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Wh(e,t));n._s.Ps(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Gh,[4,Nl(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e.I_,t),t;var e,s,n}function Gd(t){var e=this,n=this.d_,t=t;return function(n,r){var t=this;return n._s.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.wo.Ls(t,e)})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Ml(n=cf(n,Vl)),t).then(function(t){return t?new vf(n,null,t.query):null}).then(function(t){return t?new Nd(e,t):null})}var Bd=(zd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},zd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},zd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},zd);function zd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Hd,Yd,Qd={Firestore:Jp,GeoPoint:Sf,Timestamp:ai,Blob:Xp,Transaction:sd,WriteBatch:ud,DocumentReference:pd,DocumentSnapshot:Id,Query:Nd,QueryDocumentSnapshot:Ad,QuerySnapshot:Od,CollectionReference:Dd,FieldPath:Te,FieldValue:o,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Hd=e.default).INTERNAL.registerComponent(new Bd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Jp(e,new Vl(e,t),new Kp)},"PUBLIC").setServiceProps(Object.assign({},Qd))),Hd.registerVersion("@firebase/firestore","2.1.5"),(Yd=Jp).prototype.loadBundle=qd,Yd.prototype.namedQuery=Gd}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
